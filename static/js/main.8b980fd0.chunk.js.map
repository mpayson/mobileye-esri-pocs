{"version":3,"sources":["resources/images/map.png","icons.js","resources/Basic_Web_White_Logo.png","resources/images/ET_BICYCLE.png","resources/images/ET_PED_ON_HW.png","stores/AppState.js","config/esri-loader-options.js","components/filters/MinMaxSlideFilter.js","components/filters/HistMinMaxSlideFilter.js","components/filters/SelectFilter.js","components/PanelCard.js","components/FilterPanel.js","safety/LayerPanel.js","safety/RoutePanel.js","stores/objects/Filter.js","utils/Utils.js","stores/objects/SelectFilter.js","stores/objects/MinMaxFilter.js","stores/objects/MultiSelectFilter.js","stores/objects/QuantileFilter.js","stores/Store.js","safety/SafetyStore.js","safety/SafetyConfig.js","components/BookmarkPanel.js","safety/SafetyTooltip.js","safety/SafetyApp.js","events/EventsConfig.js","events/LayerPanel.js","events/EventsApp.js","components/charts/BarChart.js","components/ChartPanel.js","components/LayerListPanel.js","survey/SurveyConfig.js","survey/SurveyApp.js","config/config.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","SESSION_ID","AppState","appConfig","redirectToReferrer","this","config","session","serializedSession","localStorage","getItem","parsed","JSON","parse","tokenExpires","Date","UserSession","removeItem","newSession","setItem","serialize","redirectUri","window","location","origin","pathname","relativeRedirectUri","beginOAuth2","clientId","appId","popup","then","_registerSession","catch","er","console","log","username","decorate","observable","displayName","computed","isAuthenticated","action","bound","login","logout","options","url","css","dojoConfig","has","MinMaxSlideFilter","observer","props","context","onChange","newValues","min","max","store","onValuesChange","loaded","range","defaultValue","disabled","values","lowerBound","upperBound","lowerMark","lowerBoundLabel","toString","upperMark","upperBoundLabel","marks","step","Math","round","value","tooltipVisible","React","Component","HistMinMaxSlideFilter","labelFunction","type","label","ceil","upperBoundSupplied","isLogarithmic","pow","logBase","floor","lowerBoundSupplied","sliderRef","createRef","loadModules","HistogramRangeSlider","precision","slider","bins","excludedBarColor","rangeType","container","current","labelFormatFunction","listener","watch","remove","style","height","width","ref","Option","ButtonGroup","Group","DropdownSelectFilter","mode","children","displayOptions","map","o","domainMap","get","key","marginBottom","placeholder","onSelect","onValueChange","selectValue","BtnMultiSelectFilter","_onButtonClick","e","id","target","onValueOptionChange","selectedSet","selectedOptionSet","padding","onClick","ghost","margin","SelectFilter","Error","Panel","PanelCard","title","icon","collapsible","defaultActive","open","header","marginLeft","size","marginTop","bordered","expandIconPosition","className","defaultActiveKey","undefined","activeKey","border","customPanelStyle","borderRadius","FilterPanel","state","activeKeys","onAccordionChange","keys","setState","onToggleClick","length","filters","f","field","filterViews","alias","isActive","color","infoText","content","placement","marginRight","filter","hasHistograms","getFilterView","activeFilterKeys","onFilterAccordionChange","panelOpen","onPanelChange","onFilterToggleAllClick","toggleButtonText","position","top","left","display","clearFilters","float","Text","radioStyle","lineHeight","LayerPanel","nonMainRenderer","filterActiveKeys","filterPanelOpen","_updateAccordionForRender","rendererField","includes","nextKeys","slice","push","onRadioChange","renderer","setRendererField","onSwitchChange","isChecked","onFilterAccordionClick","onFilterPanelChange","isOpen","radioOptions","aliasMap","rendererOptions","radioValue","isSwitchChecked","checked","strong","CreateIcon","filled","InputGroup","IndicatorTitle","text","abs","spanStyle","iconType","RoutePanel","alertFading","closeAlert","clearRouteData","afterCloseAlert","alert","startIcon","editMode","startGraphic","component","endIcon","endGraphic","safetyScoreDelta","message","description","onClose","afterClose","closable","safetyTimeDelta","compact","_","onCreateClick","isSketchLoaded","cursor","startStr","endStr","generateRoutes","stdTravelTime","fontWeight","fontSize","prefix","suffix","safetyTravelTime","Filter","fieldName","params","fieldInfo","info","isDynamic","dynamic","featureLayer","fields","find","name","setFieldInfoFromLayer","where","load","getDomainMap","domain","codedValues","reduce","p","cv","set","code","Map","getMinMaxWhere","isMin","isMax","results","features","attributes","sort","getFieldDomain","queryFeatures","returnDistinctValues","outFields","_setFromQueryResults","featureLayerView","v","fieldType","getSelectWhere","Set","clear","optionSet","MinMaxFilter","numBins","rawMin","rawMax","view","getHistogram","layer","minValue","maxValue","valueExpression","histRes","lwrUprPromise","isLwr","isUpr","Promise","resolve","queries","onStatisticField","outStatisticField","statisticType","getMinQuery","getMaxQuery","outStatistics","qRes","attrs","minMaxRes","_setBoundsFromQueryResult","_setHistogramBins","maxWhere","minWhere","MultiSelectFilter","option","s","wstr","join","getMultiSelectWhere","QuantileFilter","quantiles","q","labelMap","forEach","i","pUtils","Store","appState","storeConfig","credential","chartResultMap","layerVisibleMap","tooltipResults","bookmarkInfo","layerId","layerItemId","mapId","webmapId","charts","renderers","Object","initialRendererField","popupTemplate","layerLoaded","viewConfig","hasCustomTooltip","bookmarkInfos","geocenters","effectHandler","rendererHandler","_tooltipListener","lyr","c","queryDefinition","storedResult","resultTransform","whenLayerView","lV","destroy","lyrView","loadFilters","loadCharts","layers","l","visible","on","_onMouseMove","error","onApplyFilter","debounce","layerView","autorun","_type","rendererJsonUtils","fromJSON","evt","classRef","event","hitTest","hit","_tooltipHighlight","r","graphic","screenPoint","highlight","handleEvt","isVisible","mapViewDiv","loading","WebMap","MapView","FeatureLayer","promiseUtils","esriId","registerToken","toCredential","_buildAutoRunEffects","center","zoom","portalItem","when","basemap","_loadLayers","index","bookmarks","bookmark","goTo","extent","geocenter","items","reverse","user","shallow","toggleLayerVisibility","onBookmarkClick","onClearBookmark","scoreStatQuery","outStatisticFieldName","SafetyStore","stdRoute","stdTravelScore","scoreRoute","safetyTravelScore","SketchVM","SpatialReference","sketchVM","graphics","sketchListener","onCreateComplete","routeResultLyr","geometryType","spatialReference","WebMercator","objectIdField","source","add","setAddressFromGeocode","stopType","Locator","locationToAddress","geometry","locationType","res","address","cancel","create","RouteTask","RouteParameters","FeatureSet","routeTask","routeParams","stops","outSpatialReference","impedanceAttribute","accumulateAttributes","solve","data","routeResults","route","symbol","pQuery","spatialRelationship","orderByFields","returnGeometry","pModules","all","qres","geometryEngine","polygonBarriers","scorepolys","geodesicBuffer","Name","BarrierType","Attr_Miles","generateStdRoute","generateScoreRoute","onStartClick","onEndClick","getRenderer","labels","visualVariables","safetyConfig","classBreakInfos","BookmarkPanelItem","b","PureComponent","BookmarkPanel","bookmarkViews","getQuantileLabel","SafetyTooltip","x","y","isSubsetFields","overflow","zIndex","pointerEvents","aM","infoContent","defaultBool","hasOwnProperty","percent","status","showInfo","Header","Content","Sider","MenuFilterIcon","MenuBookmarkIcon","MenuRouteFromIcon","SafetyApp","collapsed","navKey","onCollapse","item","onSignOutClick","componentDidMount","modulePromise","loadPromise","mapViewRef","Search","Legend","mapView","search","ui","legend","layerInfos","actions","removeAll","move","panel","bookmarkCard","signin","Item","tooltip","bottom","minHeight","src","MobileyeLogo","alt","defaultSelectedKeys","theme","selectedKeys","paddingLeft","paddingRight","background","span","mask","getContainer","bodyStyle","eventsConfig","uniqueValueInfos","pedImage","bicycleImage","eventFilter","eventOptions","MenuInformationIcon","EventsApp","TimeSlider","timeSlider","loop","fullTimeExtent","timeInfo","right","MyBarChart","xField","yField","chartData","queryResults","transformQueryToRechartSeries","layout","tick","dataKey","fill","chartViews","chart","BarChart","getChartView","ListLayer","onToggle","visibleMap","defaultChecked","layerListViews","surveyConfig","defaultSymbol","opacity","groupByFieldsForStatistics","result","newFeatures","fieldValue","system_type_group_label","system_type_label","expressionInfos","expression","MenuHistogramIcon","SurveyApp","ChartPanel","portalUrl","OAuth","completeOAuth2","PrivateRoute","rest","isAuth","render","to","from","Home","loadScript","topComponent","linkClass","justify","align","textAlign","md","xl","cover","MapImage","App","hash","path","exact","Boolean","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.8b980fd0.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/map.05f48ce5.png\";","// export {\r\n//   default as DownOutline\r\n// } from \"@ant-design/icons/lib/outline/DownOutline\";\r\n\r\nimport RightOutline from \"@ant-design/icons/lib/outline/RightOutline\";\r\nimport LeftOutline from \"@ant-design/icons/lib/outline/LeftOutline\";\r\nimport UpOutline from \"@ant-design/icons/lib/outline/UpOutline\";\r\nimport DownOutline from \"@ant-design/icons/lib/outline/DownOutline\";\r\nimport CloseOutline from \"@ant-design/icons/lib/outline/CloseOutline\";\r\nimport CheckOutline from \"@ant-design/icons/lib/outline/CheckOutline\";\r\nimport ArrowUpOutline from \"@ant-design/icons/lib/outline/ArrowUpOutline\";\r\nimport ArrowDownOutline from \"@ant-design/icons/lib/outline/ArrowDownOutline\";\r\nimport MinusOutline from \"@ant-design/icons/lib/outline/MinusOutline\";\r\nimport LoadingOutline from \"@ant-design/icons/lib/outline/LoadingOutline\";\r\nimport CloseCircleFill from \"@ant-design/icons/lib/fill/CloseCircleFill\";\r\nimport LogoutOutline from \"@ant-design/icons/lib/outline/LogoutOutline\";\r\nimport InfoCircleOutline from \"@ant-design/icons/lib/outline/InfoCircleOutline\";\r\nimport EyeOutline from \"@ant-design/icons/lib/outline/EyeOutline\";\r\n\r\nexport {\r\n  RightOutline,\r\n  LeftOutline,\r\n  CloseOutline,\r\n  CheckOutline,\r\n  UpOutline,\r\n  DownOutline,\r\n  ArrowUpOutline,\r\n  ArrowDownOutline,\r\n  MinusOutline,\r\n  LoadingOutline,\r\n  CloseCircleFill,\r\n  LogoutOutline,\r\n  InfoCircleOutline,\r\n  EyeOutline\r\n}","module.exports = __webpack_public_path__ + \"static/media/Basic_Web_White_Logo.cf14d591.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","import {decorate, observable, action, computed} from 'mobx';\r\nimport {\r\n  UserSession\r\n} from \"@esri/arcgis-rest-auth\";\r\n\r\nconst SESSION_ID = '__MOBILEYE_ESRI_POCS__';\r\n\r\nclass AppState {\r\n\r\n  redirectToReferrer = false;\r\n\r\n  constructor(appConfig){\r\n    this.config = appConfig;\r\n    this.session = null;\r\n    \r\n    const serializedSession = localStorage.getItem(SESSION_ID);\r\n    if(serializedSession !== null && serializedSession !== \"undefined\"){\r\n      let parsed = JSON.parse(serializedSession);\r\n      parsed.tokenExpires = new Date(parsed.tokenExpires);\r\n      if(parsed.tokenExpires > new Date()){\r\n        this.session = new UserSession(parsed);\r\n      } else {\r\n        localStorage.removeItem(SESSION_ID);\r\n      }\r\n    }\r\n  }\r\n\r\n  _registerSession(newSession){\r\n    this.session = newSession;\r\n    this.redirectToReferrer = true;\r\n    localStorage.setItem(SESSION_ID, this.session.serialize());\r\n  }\r\n\r\n  login(){\r\n    // let session\r\n    const redirectUri = `${window.location.origin}${window.location.pathname}${this.config.relativeRedirectUri}`\r\n    UserSession.beginOAuth2({\r\n      clientId: this.config.appId,\r\n      redirectUri,\r\n      popup: true\r\n    })\r\n    .then(this._registerSession)\r\n    // .then(newSession => {\r\n    //   session = newSession;\r\n    //   return session.getUser();\r\n    // })\r\n    // .then(res => {\r\n    //   this._registerSession(session);\r\n    //   console.log(res);\r\n    // })\r\n    .catch(er => console.log(er));\r\n  }\r\n\r\n  get displayName(){\r\n    // for now just show user name\r\n    if(this.session) return this.session.username;\r\n    return null;\r\n  }\r\n\r\n  get isAuthenticated(){\r\n    return !!this.session;\r\n  }\r\n\r\n  logout(){\r\n    localStorage.removeItem(SESSION_ID);\r\n    this.redirectToReferrer = false; // DO NOT REDIRECT TO REFERRER ON LOGOUT\r\n    this.session = null;\r\n  }\r\n\r\n}\r\n\r\ndecorate(AppState, {\r\n  session: observable,\r\n  redirectToReferrer: observable,\r\n  displayName: computed,\r\n  isAuthenticated: computed,\r\n  _registerSession: action.bound,\r\n  login: action.bound,\r\n  logout: action.bound\r\n})\r\n\r\nexport default AppState;","const options = {\r\n  url: \"https://js.arcgis.com/4.13/\",\r\n  // url: \"https://js.arcgis.com/4.12/\",\r\n  // css: \"/jscss/my-theme/main.css\",\r\n  // css: true,\r\n  css: \"https://js.arcgis.com/4.13/esri/themes/light/main.css\",\r\n  dojoConfig: {\r\n    has: {\r\n      \"esri-native-promise\": true\r\n    }\r\n  }\r\n}\r\n\r\nexport default options;","import React from 'react';\r\nimport { Slider } from 'antd';\r\nimport { observer } from \"mobx-react\";\r\n\r\nconst MinMaxSlideFilter = observer(class MinMaxSlideFilter extends React.Component{\r\n  \r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.store = props.store;\r\n  }\r\n\r\n  onChange = (newValues) => {\r\n    const [min, max] = newValues;\r\n    this.store.onValuesChange(min, max);\r\n  }\r\n  \r\n  render(){\r\n\r\n    if(!this.store.loaded){\r\n      return <Slider\r\n        range\r\n        min={0}\r\n        max={100}\r\n        defaultValue={[0, 100]}\r\n        disabled={true}\r\n      />\r\n    }\r\n\r\n    const min = this.store.min || this.store.min === 0\r\n      ? this.store.min\r\n      : this.store.lowerBound;\r\n    const max = this.store.max || this.store.max === 0\r\n      ? this.store.max\r\n      : this.store.upperBound;\r\n    const values = [min, max];\r\n\r\n    // should marks live in the store?\r\n    const lowerMark = this.props.lowerBoundLabel\r\n      ? this.props.lowerBoundLabel\r\n      : this.store.lowerBound.toString();\r\n\r\n    const upperMark = this.props.upperBoundLabel\r\n      ? this.props.upperBoundLabel\r\n      : this.store.upperBound.toString();\r\n\r\n    const marks = {\r\n      [this.store.lowerBound]: lowerMark,\r\n      [this.store.upperBound]: upperMark\r\n    }\r\n\r\n    // 100 step values to 2 point precision (eg Math.round(trueStep * 100) / 100)\r\n    const step = Math.round(this.store.upperBound - this.store.lowerBound) / 100;\r\n\r\n    return(\r\n      <Slider\r\n        range\r\n        min={this.store.lowerBound}\r\n        max={this.store.upperBound}\r\n        marks={marks}\r\n        defaultValue={[this.store.lowerBound, this.store.upperBound]}\r\n        value={values}\r\n        onChange={this.onChange}\r\n        disabled={!this.store.loaded}\r\n        step={step}\r\n        tooltipVisible={false}\r\n      />\r\n    )\r\n  }\r\n})\r\n\r\nexport default MinMaxSlideFilter;\r\n\r\n","import React from 'react';\r\nimport {loadModules} from 'esri-loader';\r\nimport { observer } from \"mobx-react\";\r\nimport options from '../../config/esri-loader-options';\r\n\r\nconst HistMinMaxSlideFilter = observer(class HistMinMaxSlideFilter extends React.Component{\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.sliderRef = React.createRef();\r\n    this.store = props.store;\r\n  }\r\n\r\n  onValuesChange = (newValues) => {\r\n    const [min, max] = newValues;\r\n    this.store.onValuesChange(min, max);\r\n  }\r\n\r\n  labelFunction = (value, type) => {\r\n    let label = ''\r\n    if (type === \"max\")\r\n      label = Math.ceil((!this.store.upperBoundSupplied && this.store.isLogarithmic) ? Math.pow(this.store.logBase,this.store.upperBound ) : this.store.upperBound);\r\n    if (type === \"min\") {\r\n      label = 0\r\n      if (this.store.lowerBound !== 0)\r\n        label = Math.floor((!this.store.lowerBoundSupplied && this.store.isLogarithmic) ? Math.pow(this.store.logBase, this.store.lowerBound) : this.store.lowerBound);\r\n    }\r\n    return label;\r\n  }\r\n\r\n  componentDidMount(){\r\n    loadModules([\r\n      'esri/widgets/HistogramRangeSlider',\r\n    ], options)\r\n    .then(([HistogramRangeSlider]) => {\r\n      const precision = this.store.isLogarithmic ? 4 : 1;\r\n      this.slider = new HistogramRangeSlider({\r\n        bins: this.store.bins,\r\n        min: this.store.lowerBound,\r\n        max: this.store.upperBound,\r\n        values: [\r\n          this.store.min || this.store.lowerBound,\r\n          this.store.max || this.store.upperBound\r\n        ],\r\n        excludedBarColor: \"#bfbfbf\",\r\n        rangeType: \"between\",\r\n        container: this.sliderRef.current,\r\n        precision\r\n      });\r\n      this.slider.labelFormatFunction = this.labelFunction;\r\n\r\n      this.listener = this.slider.watch(\"values\", this.onValuesChange);\r\n    })\r\n    .catch(er => console.log(er));\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    if(this.listener) this.listener.remove();\r\n  }\r\n\r\n  render(){\r\n\r\n    // needed to register these as observable with mobx\r\n    const min = this.store.min || this.store.min === 0\r\n      ? this.store.min\r\n      : this.store.lowerBound;\r\n    const max = this.store.max || this.store.max === 0\r\n      ? this.store.max\r\n      : this.store.upperBound;\r\n\r\n    if(this.slider && this.store.loaded){\r\n      this.slider.bins = this.store.bins;\r\n      this.slider.min = this.store.lowerBound;\r\n      this.slider.max = this.store.upperBound;\r\n      this.slider.values = [min, max];\r\n    }\r\n\r\n    return(\r\n      <div style={{height: \"6rem\", width: \"100%\"}}>\r\n        <div ref={this.sliderRef}></div>\r\n      </div>\r\n    )\r\n  }\r\n});\r\n\r\nexport default HistMinMaxSlideFilter;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { Select, Button } from 'antd';\r\nconst { Option } = Select;\r\nconst ButtonGroup = Button.Group;\r\n\r\nconst DropdownSelectFilter = observer(({store, mode}) => {\r\n  const children = store.displayOptions.map(o => {\r\n    let label = o;\r\n    if (store.domainMap.has(o)) {\r\n        label = store.domainMap.get(o);\r\n    }\r\n    return <Option key={o}>{label}</Option>\r\n  })\r\n  return (\r\n    <div style={{marginBottom: \"1rem\"}}>\r\n      <Select\r\n        mode={mode}\r\n        style={{ width: '100%' }}\r\n        placeholder=\"Please select\"\r\n        onSelect={mode === \"multiple\" ? null : store.onValueChange}\r\n        onChange={mode === \"multiple\" ? store.onValueChange : null}\r\n        value={store.selectValue}\r\n      >\r\n        {children}\r\n      </Select>\r\n    </div>\r\n  )\r\n})\r\n\r\nconst BtnMultiSelectFilter = observer(class BtnMultiSelectFilter extends React.Component{\r\n\r\n  _onButtonClick = (e) => {\r\n    const id = e.target.id;\r\n    this.props.store.onValueOptionChange(id);\r\n  }\r\n\r\n  render(){\r\n    const selectedSet = this.props.store.selectedOptionSet;\r\n    const domainMap = this.props.store.domainMap;\r\n    const children = this.props.store.displayOptions.map(o => {\r\n      let label = o;\r\n      if (domainMap.has(o)) {\r\n          label = domainMap.get(o);\r\n      }\r\n      return (\r\n        <Button\r\n          id={o}\r\n          style={{padding: \"0px 10px\"}}\r\n          onClick={this._onButtonClick}\r\n          // size=\"small\"\r\n          key={o}\r\n          type={selectedSet.has(o) ? 'primary' : 'dashed'}\r\n          ghost={selectedSet.has(o) ? true : false}>\r\n          {label}\r\n        </Button>\r\n      )\r\n    });\r\n\r\n    return (\r\n      <div style={{marginBottom: \"1rem\", margin: \"auto\"}}>\r\n        <ButtonGroup>\r\n          {children}\r\n        </ButtonGroup>\r\n      </div>\r\n    )\r\n  }\r\n\r\n});\r\n\r\n\r\nconst SelectFilter = observer( ({store, mode, style}) => {\r\n  if(style !== 'buttons') return <DropdownSelectFilter store={store} mode={mode}/>;\r\n  if(mode !== 'multiple') throw new Error('Button selects only support multiple for now');\r\n  return <BtnMultiSelectFilter store={store}/>\r\n})\r\n\r\nexport default SelectFilter;","import React from 'react';\r\nimport { Collapse, Card } from 'antd';\r\nimport './PanelCard.css';\r\nconst { Panel } = Collapse;\r\n\r\nconst PanelCard = ({title, icon, collapsible, defaultActive, children, open, onChange}) => {\r\n\r\n  const header = icon\r\n    ? <h1 style={{padding: \"0px\"}}>{icon}<span style={{marginLeft: \"10px\"}}>{title}</span></h1>\r\n    : <h1 style={{padding: \"0px\"}}>{title}</h1>;\r\n\r\n  if(!collapsible){\r\n    return (\r\n      <Card size=\"small\" style={{marginTop: \"10px\"}}>\r\n        {header}\r\n        {children}\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  const defaultActiveKeys = defaultActive\r\n    ? ['panel-card']\r\n    : [];\r\n\r\n  let props = {\r\n    bordered: false,\r\n    expandIconPosition: 'right',\r\n    className: 'no-padding',\r\n    defaultActiveKey: defaultActiveKeys\r\n  }\r\n  if(open !== undefined && onChange){\r\n    props.activeKey = open ? ['panel-card'] : [];\r\n    props.onChange = onChange\r\n  }\r\n\r\n  return(\r\n    <Card size=\"small\" style={{marginTop: \"10px\"}}>\r\n      <Collapse\r\n        {...props}>\r\n        <Panel\r\n          header={header}\r\n          style={{border: 0}}\r\n          className=\"no-padding\"\r\n          key=\"panel-card\">\r\n          {children}\r\n        </Panel>\r\n      </Collapse>\r\n\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default PanelCard;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport MinMaxSlideFilter from './filters/MinMaxSlideFilter';\r\nimport HistMinMaxSlideFilter from './filters/HistMinMaxSlideFilter';\r\nimport SelectFilter from './filters/SelectFilter';\r\nimport LayerFilterIcon from 'calcite-ui-icons-react/LayerFilterIcon';\r\nimport PanelCard from './PanelCard';\r\nimport { Collapse, Button, Icon, Popover } from 'antd';\r\nimport './FilterPanel.css';\r\nconst { Panel } = Collapse;\r\n\r\nconst getFilterView = (filter) => {\r\n  const f = filter;\r\n  switch(filter.type){\r\n    case 'minmax':\r\n      return f.hasHistograms\r\n        ? <HistMinMaxSlideFilter store={f} key={f.field}/>\r\n        : <MinMaxSlideFilter store={f} key={f.field} lowerBoundLabel={f.lowerBoundLabel} upperBoundLabel={f.upperBoundLabel}/>\r\n    case 'multiselect':\r\n      return <SelectFilter store={f} key={f.field} mode=\"multiple\" style={f.style}/>\r\n    case 'select':\r\n      return <SelectFilter store={f} key={f.field} style={f.style}/>\r\n    case 'quantile':\r\n      return <SelectFilter store={f} key={f.field} mode=\"multiple\" style={f.style}/>\r\n    default:\r\n      throw new Error(\"Unknown filter type!\");\r\n  }\r\n}\r\n\r\nconst customPanelStyle = {\r\n  borderRadius: 4,\r\n  border: 0\r\n};\r\n\r\nconst FilterPanel = observer(class FilterPanel extends React.Component{\r\n\r\n  state = {\r\n    activeKeys: []\r\n  }\r\n\r\n  onAccordionChange = (keys) => {\r\n    this.setState({\r\n      activeKeys: keys\r\n    })\r\n  }\r\n\r\n  onToggleClick = () => {\r\n    if(this.state.activeKeys.length > 0){\r\n      this.setState({\r\n        activeKeys: []\r\n      });\r\n    } else {\r\n      const keys = this.props.store.filters.map(f => f.field);\r\n      this.setState({\r\n        activeKeys: keys\r\n      })\r\n    }\r\n  }\r\n\r\n  render(){\r\n    const filters = this.props.store.filters;\r\n    const filterViews = filters.map(f => {\r\n      const alias = f.isActive\r\n        ? <span style={{color: '#00abbc'}}><b>{f.alias}</b></span>\r\n        : f.alias;\r\n      let header = f.infoText\r\n        ? <>\r\n            <Popover content={f.infoText} placement=\"topLeft\">\r\n              <Icon\r\n                type=\"info-circle\"\r\n                style={{marginRight: \"3px\", color: f.isActive ? '#00abbc' : undefined}}/>\r\n            </Popover>\r\n            {alias}\r\n          </>\r\n        : alias;\r\n      return (\r\n        <Panel header={header} key={f.field} style={customPanelStyle} className='minimal-padding'>\r\n          {getFilterView(f)}\r\n        </Panel>\r\n      )\r\n    });\r\n\r\n    const defaultActive = this.props.defaultActive || false;\r\n\r\n    const activeKeys = this.props.activeFilterKeys || this.state.activeKeys;\r\n    const onAccordionChange = this.props.onFilterAccordionChange || this.onAccordionChange;\r\n\r\n    const panelOpen = this.props.panelOpen === undefined ? undefined : this.props.panelOpen;\r\n    const onPanelChange = this.props.onPanelChange ? this.props.onPanelChange : undefined;\r\n    const onToggleClick = this.props.onFilterToggleAllClick ? this.props.onFilterToggleAllClick : this.onToggleClick;\r\n\r\n    const toggleButtonText = activeKeys.length > 0\r\n    ? 'Close all'\r\n    : 'Open all';\r\n\r\n    return (\r\n      <PanelCard\r\n        title=\"Filter\"\r\n        icon={<LayerFilterIcon size=\"20\" style={{position: \"relative\", top: \"3px\", left: \"0px\"}}/>}\r\n        collapsible={true}\r\n        open={panelOpen}\r\n        onChange={onPanelChange}\r\n        defaultActive={defaultActive}>\r\n        <div style={{display: \"inline-block\", width: \"100%\", padding: \"0px 15px 10px 5px\"}}>\r\n          <Button type=\"danger\" size=\"small\" ghost  onClick={this.props.store.clearFilters}>Clear</Button>\r\n          <Button size=\"small\" onClick={onToggleClick} style={{float: \"right\"}}>{toggleButtonText}</Button>\r\n        </div>\r\n          <Collapse\r\n            activeKey={activeKeys}\r\n            bordered={false}\r\n            expandIconPosition='right'\r\n            onChange={onAccordionChange}>\r\n            {filterViews}\r\n          </Collapse>\r\n      </PanelCard>\r\n\r\n    )\r\n  }\r\n  \r\n});\r\n\r\nexport default FilterPanel;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport {\r\n  Switch,\r\n  Radio,\r\n  Typography } from 'antd';\r\nimport FilterPanel from '../components/FilterPanel';\r\nimport PanelCard from '../components/PanelCard';\r\nimport LayerIcon from 'calcite-ui-icons-react/LayerIcon';\r\n\r\nconst { Text } = Typography;\r\n\r\nconst radioStyle = {\r\n  display: 'block',\r\n  height: '30px',\r\n  lineHeight: '30px',\r\n};\r\n\r\nconst LayerPanel = observer(class LayerPanel extends React.Component{\r\n\r\n  nonMainRenderer = 'harsh_acc_ratio';\r\n\r\n  state = {\r\n    filterActiveKeys: [],\r\n    filterPanelOpen: false\r\n  }\r\n\r\n  _updateAccordionForRender = (rendererField) => {\r\n    if(this.state.filterActiveKeys.includes(rendererField)) return;\r\n    const nextKeys = this.state.filterActiveKeys.slice();\r\n    nextKeys.push(rendererField);\r\n    this.setState({\r\n      filterActiveKeys: nextKeys,\r\n      filterPanelOpen: true\r\n    })\r\n  }\r\n\r\n  onRadioChange = (e) => {\r\n    let renderer = e.target.value;\r\n    this.nonMainRenderer = renderer;\r\n    this.props.store.setRendererField(renderer);\r\n    this._updateAccordionForRender(renderer);\r\n  }\r\n\r\n  onSwitchChange = (isChecked) => {\r\n    if(isChecked){\r\n      this.props.store.setRendererField('eventvalue');\r\n      this._updateAccordionForRender('eventvalue');\r\n    } else {\r\n      this.props.store.setRendererField(this.nonMainRenderer);\r\n      this._updateAccordionForRender(this.nonMainRenderer);\r\n    }\r\n  }\r\n\r\n  onFilterAccordionClick = (keys) => {\r\n    this.setState({\r\n      filterActiveKeys: keys\r\n    });\r\n  }\r\n\r\n  onFilterToggleAllClick = () => {\r\n    if(this.state.filterActiveKeys.length > 0){\r\n      this.setState({\r\n        filterActiveKeys: []\r\n      });\r\n    } else {\r\n      const keys = this.props.store.filters.map(f => f.field);\r\n      this.setState({\r\n        filterActiveKeys: keys\r\n      })\r\n    }\r\n  }\r\n\r\n  onFilterPanelChange = () => {\r\n    const isOpen = !this.state.filterPanelOpen;\r\n    this.setState({\r\n      filterPanelOpen: isOpen\r\n    })\r\n  }\r\n\r\n  render(){\r\n\r\n    let radioOptions;\r\n    if(this.props.store.aliasMap){\r\n      radioOptions = this.props.store.rendererOptions\r\n        .filter(o => o !== 'eventvalue')\r\n        .map(o => \r\n          <Radio value={o} key={o} style={radioStyle}>{this.props.store.aliasMap.get(o)}</Radio>\r\n        )\r\n    }\r\n\r\n    let radioValue = this.props.store.rendererField === 'eventvalue'\r\n      ? this.nonMainRenderer\r\n      : this.props.store.rendererField;\r\n\r\n    const isSwitchChecked = this.props.store.rendererField === 'eventvalue';\r\n\r\n    return (\r\n      <>\r\n        <PanelCard\r\n          icon={<LayerIcon size=\"20\" style={{position: \"relative\", top: \"4px\", left: \"0px\"}}/>}\r\n          title=\"Layer Selection\"\r\n          collapsible={true}\r\n          defaultActive={true}>\r\n          <div>\r\n            <Switch\r\n              onChange={this.onSwitchChange}\r\n              checked={isSwitchChecked}\r\n              style={{float: \"left\", marginTop: \"1px\"}}/>\r\n            <h3 style={{display: \"inline-block\", margin: \"0px 0px 2px 10px\"}}>Road Risk Score</h3>\r\n          </div>\r\n          <p style={{margin: \"10px 0px 5px 0px\"}}><Text strong> Toggle Road Risk Score off to explore individual data layers of the overall score</Text></p>\r\n          <Radio.Group\r\n            disabled={isSwitchChecked}\r\n            onChange={this.onRadioChange}\r\n            value={radioValue}>\r\n            {radioOptions}\r\n          </Radio.Group>\r\n        </PanelCard>\r\n        <FilterPanel\r\n          store={this.props.store}\r\n          panelOpen={this.state.filterPanelOpen}\r\n          onPanelChange={this.onFilterPanelChange}\r\n          activeFilterKeys={this.state.filterActiveKeys}\r\n          onFilterAccordionChange={this.onFilterAccordionClick}\r\n          onFilterToggleAllClick={this.onFilterToggleAllClick}/>\r\n      </>\r\n    )\r\n  }\r\n\r\n});\r\n\r\nexport default LayerPanel;\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport {\r\n  Input,\r\n  Button,\r\n  Icon,\r\n  Statistic,\r\n  Card,\r\n  Divider,\r\n  Alert\r\n} from 'antd';\r\nimport PinIcon from 'calcite-ui-icons-react/PinPlusIcon';\r\n\r\nconst CreateIcon = () => (\r\n  <PinIcon filled size=\"17\"/>\r\n)\r\n\r\nconst InputGroup = Input.Group;\r\n\r\n\r\nconst IndicatorTitle = ({title, value}) => {\r\n  const text = value || value === 0\r\n    ? ` ${Math.round(Math.abs(value))}%`\r\n    : ' - - %';\r\n  let spanStyle = {float: 'right'};\r\n  let iconType = 'arrow-down';\r\n  if(value && value >= 0){\r\n    spanStyle.color = '#f5222d';\r\n    iconType = 'arrow-up';\r\n  } else if (value && value < 0){\r\n    spanStyle.color = '#52c41a';\r\n    iconType = 'arrow-down';\r\n  }\r\n  return (\r\n    <div>\r\n      {title}\r\n      <span style={spanStyle}>\r\n        <Icon type={iconType}/>\r\n        <b>{text}</b>\r\n      </span>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst RoutePanel = observer(class RoutePanel extends React.Component{\r\n\r\n  alertFading = false;\r\n\r\n  componentWillUnmount(){\r\n    this.props.store.clearRouteData();\r\n  }\r\n\r\n  closeAlert = () => {\r\n    this.alertFading = true;\r\n    this.props.store.clearRouteData();\r\n  }\r\n\r\n  afterCloseAlert = () => {\r\n    this.alertFading = false;\r\n  }\r\n\r\n\r\n\r\n  render(){\r\n    const store = this.props.store;\r\n\r\n    const startIcon = store.editMode === 'start' || store.startGraphic\r\n      ? <Icon type='close'/>\r\n      : <Icon component={CreateIcon} />;\r\n    \r\n    const endIcon = store.editMode === 'end' || store.endGraphic\r\n      ? <Icon type='close'/>\r\n      : <Icon component={CreateIcon} />\r\n\r\n    let alert;\r\n    if ( (store.safetyScoreDelta && store.safetyScoreDelta > 0) || this.alertFading){\r\n      alert = (\r\n        <Alert\r\n        style={{marginBottom: \"10px\"}}\r\n        message=\"Invalid Results\"\r\n        description=\"For a POC, we only consider high scoring roads, which can cause poor results in areas with many low scoring roads. Close this alert to reset\"\r\n        type=\"error\"\r\n        onClose={this.closeAlert}\r\n        afterClose={this.afterCloseAlert}\r\n        closable/>\r\n      )\r\n    } else if((store.safetyTimeDelta && store.safetyTimeDelta > 25) || this.alertFading){\r\n      alert = (\r\n        <Alert\r\n        style={{marginBottom: \"10px\"}}\r\n        message=\"Unrealistic Results\"\r\n        description=\"Time difference is too high.\"\r\n        type=\"warning\"\r\n        onClose={this.closeAlert}\r\n        afterClose={this.afterCloseAlert}\r\n        closable/>\r\n      )\r\n    } \r\n\r\n    console.log(store.safetyTimeDelta && store.safetyTimeDelta < 5);\r\n\r\n    return(\r\n      <>\r\n        <p>Route Start</p>\r\n        <InputGroup compact style={{marginBottom: \"15px\"}}>\r\n          <Button\r\n            style={{padding: \"0px 10px\"}}\r\n            onClick={_ => store.onCreateClick('start')}\r\n            disabled={!store.isSketchLoaded}>\r\n            {startIcon}\r\n          </Button>\r\n          <Input\r\n            disabled\r\n            style={{width: 'calc(100% - 40px)', cursor: 'default'}}\r\n            value={store.startStr}>\r\n          </Input>\r\n        </InputGroup>\r\n        <p>Route End</p>\r\n        <InputGroup compact style={{marginBottom: \"30px\"}}>\r\n          <Button\r\n            style={{padding: \"0px 10px\"}}\r\n            onClick={_ => store.onCreateClick('end')}\r\n            disabled={!store.isSketchLoaded}>\r\n            {endIcon}\r\n          </Button>\r\n          <Input\r\n            disabled\r\n            style={{width: 'calc(100% - 40px)', cursor: 'default'}}\r\n            value={store.endStr}>\r\n          </Input>\r\n        </InputGroup>\r\n        <Button\r\n          size=\"large\"\r\n          style={{width: \"65%\", marginRight: \"5px\"}}\r\n          disabled={!(store.startGraphic && store.endGraphic)}\r\n          type=\"primary\"\r\n          onClick={store.generateRoutes}>\r\n          Generate routes\r\n        </Button>\r\n        <Button\r\n          type=\"danger\"\r\n          size=\"large\"\r\n          disabled={!(store.startGraphic || store.endGraphic || store.stdTravelTime)}\r\n          ghost\r\n          onClick={store.clearRouteData}>\r\n            Clear\r\n        </Button>\r\n        <Divider/>\r\n        {alert}\r\n        <Card\r\n          size=\"small\"\r\n          style={{marginBottom: '15px'}}>\r\n          <span style={{color: \"rgba(0, 0, 0, 0.85)\", fontWeight: \"500\", fontSize: \"14px\"}}>\r\n            <IndicatorTitle title=\"Travel Risk Score Change\" value={store.safetyScoreDelta}/>\r\n          </span>\r\n          {/* <Statistic\r\n            title=\"Without accounting for risk\"\r\n            value={store.stdTravelScore ? store.stdTravelScore : ' - - '}\r\n            precision={2}\r\n            prefix={<Icon type=\"minus\" style={{color: 'rgb(94, 43, 255)'}}/>}\r\n          />\r\n          <Statistic\r\n            title=\"Accounting for risk\"\r\n            value={store.safetyTravelScore ? store.safetyTravelScore : ' - - '}\r\n            precision={2}\r\n            prefix={<Icon type=\"minus\" style={{color: \"rgb(227, 69, 143)\"}}/>}\r\n          /> */}\r\n        </Card>\r\n        <Card\r\n          title={<IndicatorTitle title=\"Travel Time Change\" value={store.safetyTimeDelta}/>}\r\n          size=\"small\">\r\n          <Statistic\r\n            title=\"Without accounting for risk\"\r\n            value={store.stdTravelTime ? store.stdTravelTime : ' - - '}\r\n            precision={0}\r\n            prefix={<Icon type=\"minus\" style={{color: 'rgb(94, 43, 255)'}}/>}\r\n            suffix=\"min\"\r\n          />\r\n          <Statistic\r\n            title=\"Accounting for risk\"\r\n            value={store.safetyTravelTime ? store.safetyTravelTime : ' - - '}\r\n            precision={0}\r\n            prefix={<Icon type=\"minus\" style={{color: \"rgb(227, 69, 143)\"}}/>}\r\n            suffix=\"min\"\r\n          />\r\n        </Card>\r\n\r\n      </>\r\n    ) \r\n  }\r\n});\r\n\r\nexport default RoutePanel;","import { decorate, observable, computed, action } from 'mobx';\r\n\r\nclass Filter {\r\n  constructor(fieldName, params = null){\r\n    this.field = fieldName;\r\n    this.fieldInfo = {};\r\n    this.infoText = params && params.info ? params.info : null;\r\n    this.isDynamic = params && params.dynamic ? params.dynamic : false;\r\n    // this.caption = (params !== null && \"caption\" in params) ? params.caption : null;\r\n  }\r\n\r\n  setFieldInfoFromLayer(featureLayer){\r\n    this.fieldInfo = featureLayer.fields.find(f => f.name === this.field);\r\n  }\r\n\r\n  load(featureLayer){\r\n    if(!featureLayer.loaded){\r\n      throw new Error(\"Please wait until the layer is loaded\");\r\n    }\r\n    this.setFieldInfoFromLayer(featureLayer);\r\n  }\r\n  get alias(){\r\n    // if (this.caption !== null) return this.caption;\r\n    if(this.fieldInfo) return this.fieldInfo.alias;\r\n    return null;\r\n  }\r\n\r\n  get where(){\r\n    return null;\r\n  }\r\n  \r\n  get isActive(){\r\n    return !!this.where;\r\n  }\r\n\r\n}\r\n\r\ndecorate(Filter, {\r\n  fieldInfo: observable,\r\n  alias: computed,\r\n  where: computed,\r\n  isActive: computed,\r\n  load: action.bound,\r\n  setFieldInfoFromLayer: action.bound\r\n})\r\n\r\nexport default Filter;","const getDomainMap = (domain) => {\r\n  if(!domain) return new Map();\r\n  return domain.codedValues.reduce((p, cv) => {\r\n    p.set(cv.code, cv.name);\r\n    return p;\r\n  }, new Map());\r\n}\r\n\r\nconst transformQueryToRechartSeries = (queryResults, xField, yField) => {\r\n  if(!queryResults || queryResults.features.length < 1) return [];\r\n  return queryResults.features.map(f => ({\r\n    [xField]: f.attributes[xField],\r\n    [yField]: f.attributes[yField]\r\n  }));\r\n}\r\n\r\nconst getMinMaxWhere = (field, min, max) => {\r\n  const isMin = min || min === 0;\r\n  const isMax = max || max === 0;\r\n  let where = null;\r\n  if(isMin && isMax){\r\n    where = field + \" <= \" + max + \" AND \" + field + \" >= \" + min;\r\n  } else if(isMax){\r\n    where = field + \" <= \" + max;\r\n  } else if(isMin){\r\n    where = field + \" >= \" + min;\r\n  }\r\n  return where;\r\n}\r\n\r\nconst getMultiSelectWhere = (field, values, fieldType) => {\r\n  if(!values || values.length < 1) return null;\r\n  let where = null;\r\n  if(fieldType === 'string') {\r\n    const wstr = values.join(\"','\");\r\n    where = `${field} IN ('${wstr}')`;\r\n  } else {\r\n    const wstr = values.join(\",\");\r\n    where =  `${field} IN (${wstr})`;\r\n  }\r\n  return where;\r\n}\r\n\r\nconst getSelectWhere = (field, value, fieldType) => {\r\n  if(!value) return null;\r\n  let where = null;\r\n  where = (fieldType === 'string')\r\n    ? `${field} = '${value}'` :\r\n    `${field} = ${value}`;\r\n  return where\r\n}\r\n\r\nconst getMaxQuery = (field) => ({\r\n  onStatisticField: field,\r\n  outStatisticField: `MAX_${field}`,\r\n  statisticType: 'max'\r\n})\r\n\r\nconst getMinQuery = (field) => ({\r\n  onStatisticField: field,\r\n  outStatisticField: `MIN_${field}`,\r\n  statisticType: 'min'\r\n})\r\n\r\nexport {\r\n  getMinMaxWhere,\r\n  getMultiSelectWhere,\r\n  getSelectWhere,\r\n  getMaxQuery,\r\n  getMinQuery,\r\n  getDomainMap,\r\n  transformQueryToRechartSeries\r\n};","import Filter from './Filter';\r\nimport { decorate, observable, action, computed } from 'mobx';\r\nimport { getSelectWhere, getDomainMap } from '../../utils/Utils';\r\n\r\nclass SelectFilter extends Filter{\r\n  type = 'select';\r\n  loaded = false;\r\n  options = [];\r\n  selectValue = null;\r\n  domainMap = new Map();\r\n\r\n  constructor(fieldName, params=null){\r\n    super(fieldName, params);\r\n    this.style = params && params.style ? params.style : 'dropdown';\r\n  }\r\n  _setFromQueryResults(results){\r\n    this.options = results.features.map(f => \r\n      f.attributes[this.field]\r\n    ).sort();\r\n    this.loaded = true;\r\n  }\r\n\r\n  load(featureLayer){\r\n    super.load(featureLayer);\r\n    const domain = featureLayer.getFieldDomain(this.field);\r\n    if(domain){\r\n      this.domainMap = getDomainMap(domain);\r\n    }\r\n    featureLayer.queryFeatures({\r\n      where: \"1=1\",\r\n      returnDistinctValues: true,\r\n      outFields: [this.field]\r\n    }).then(this._setFromQueryResults);\r\n  }\r\n\r\n  // execute client-side query based on what's currently available\r\n  refresh(featureLayer, featureLayerView, where=\"1=1\"){\r\n    super.load(featureLayer);\r\n    const domain = featureLayer.getFieldDomain(this.field);\r\n    if(domain){\r\n      this.domainMap = getDomainMap(domain);\r\n    }\r\n    featureLayerView.queryFeatures({\r\n      where,\r\n      returnDistinctValues: true,\r\n      outFields: [this.field]\r\n    }).then(this._setFromQueryResults);\r\n  }\r\n\r\n  onValueChange(v){\r\n    if(this.selectValue === v){\r\n      this.selectValue = null;\r\n    } else {\r\n      this.selectValue = v;\r\n    }\r\n  }\r\n\r\n  clear(){\r\n    this.selectValue = null;\r\n  }\r\n\r\n  get where(){\r\n    return getSelectWhere(this.field, this.selectValue, this.fieldInfo.type);\r\n  }\r\n\r\n  get optionSet(){\r\n    return new Set(this.options);\r\n  }\r\n\r\n  get displayOptions(){\r\n    return this.options.slice().sort();\r\n  }\r\n\r\n}\r\n\r\ndecorate(SelectFilter, {\r\n  options: observable,\r\n  loaded: observable,\r\n  selectValue: observable,\r\n  load: action.bound,\r\n  where: computed,\r\n  onValueChange: action.bound,\r\n  clear: action.bound,\r\n  _setFromQueryResults: action.bound,\r\n  optionSet: computed,\r\n  displayOptions: computed\r\n})\r\n\r\nexport default SelectFilter;","import Filter from './Filter';\r\nimport { decorate, observable, action, computed } from 'mobx';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../../config/esri-loader-options';\r\nimport {getMinQuery, getMaxQuery, getMinMaxWhere } from '../../utils/Utils';\r\n\r\nclass MinMaxFilter extends Filter{\r\n\r\n  type = 'minmax';\r\n  bins = [];\r\n  loaded = false;\r\n  min = null;\r\n  max = null;\r\n\r\n  constructor(fieldName, params){\r\n    super(fieldName, params);\r\n    this.lowerBound = params.lowerBound || null;\r\n    this.upperBound = params.upperBound || null;\r\n    this.upperBoundSupplied = this.upperBound !== null;\r\n    this.lowerBoundSupplied = this.lowerBound !== null;\r\n    this.logBase = 10;\r\n    this.isLogarithmic = params.isLogarithmic || false;\r\n    this.numBins = (typeof params.numBins === 'undefined') ? 50 : params.numBins;\r\n    this.hasHistograms = params.hasHistograms || false;\r\n    this.upperBoundLabel = params.upperBoundLabel || null;\r\n    this.lowerBoundLabel = params.lowerBoundLabel || null;\r\n  }\r\n\r\n  _setBoundsFromQueryResult([rawMin, rawMax]){\r\n    this.lowerBound = Math.floor(rawMin);\r\n    this.upperBound = Math.ceil(rawMax);\r\n    if (this.isLogarithmic){\r\n      if (!this.lowerBoundSupplied && this.lowerBound !== 0)\r\n        this.lowerBound = Math.floor((Math.log(this.lowerBound) / Math.log(this.logBase)) * 100) / 100;\r\n      if (!this.upperBoundSupplied && this.upperBound !== 0)\r\n        this.upperBound = Math.ceil((Math.log(this.upperBound) / Math.log(this.logBase)) * 100) / 100;\r\n    }\r\n    return [this.lowerBound, this.upperBound];\r\n  }\r\n\r\n  _setHistogramBins(featureLayer, view){\r\n    return loadModules([\r\n      'esri/renderers/smartMapping/statistics/histogram'\r\n    ], options)\r\n    .then(([getHistogram]) => \r\n      getHistogram({\r\n        layer: featureLayer,\r\n        field: this.field,\r\n        numBins: this.numBins,\r\n        minValue: this.lowerBound,\r\n        maxValue: this.upperBound,\r\n        valueExpression: this.isLogarithmic ? `IIf($feature.${this.field} != 0,Log($feature.${this.field}) / Log(${this.logBase}),0)` : `$feature.${this.field}`,\r\n        view\r\n      })\r\n    ).then(histRes => {\r\n      this.bins = histRes.bins;\r\n    })\r\n  };\r\n\r\n  load(featureLayer, view){\r\n    super.load(featureLayer);\r\n    const field = this.field;\r\n\r\n    const isLwr = this.lowerBound || this.lowerBound === 0;\r\n    const isUpr = this.upperBound || this.upperBound === 0;\r\n\r\n    let lwrUprPromise;\r\n    if(isLwr && isUpr){\r\n      lwrUprPromise = Promise.resolve([this.lowerBound, this.upperBound]);\r\n    } else {\r\n      let queries = [];\r\n      if(!isLwr) queries.push(getMinQuery(field));\r\n      if(!isUpr) queries.push(getMaxQuery(field));\r\n      lwrUprPromise = featureLayer.queryFeatures({\r\n        where: \"1=1\",\r\n        outStatistics: queries\r\n      }).then(qRes => {\r\n        const attrs = qRes.features[0].attributes;\r\n        return [\r\n          isLwr ? this.lowerBound : attrs[`MIN_${field}`],\r\n          isUpr ? this.upperBound : attrs[`MAX_${field}`]\r\n        ]\r\n      })\r\n    }\r\n\r\n    lwrUprPromise.then(minMaxRes => {\r\n      this._setBoundsFromQueryResult(minMaxRes);\r\n      if(this.hasHistograms) {\r\n        return this._setHistogramBins(featureLayer, view)\r\n      }\r\n      return Promise.resolve();\r\n    })\r\n    .then(_ => this.loaded = true);\r\n\r\n  }\r\n\r\n  onValuesChange(min, max){\r\n    this.min = min;\r\n    this.max = max;\r\n  }\r\n\r\n  clear(){\r\n    this.min = this.lowerBound;\r\n    this.max = this.upperBound;\r\n  }\r\n\r\n  get where(){\r\n    let where;\r\n    if(this.min <= this.lowerBound && this.max >= this.upperBound){\r\n      where = null;\r\n    } else {\r\n      let maxWhere = (!this.upperBoundSupplied && this.isLogarithmic) ? Math.pow(this.logBase, this.max) : this.max;\r\n      let minWhere = (!this.lowerBoundSupplied && this.isLogarithmic) ? Math.pow(this.logBase, this.min) : this.min;\r\n      where = getMinMaxWhere(this.field, minWhere, maxWhere);\r\n    }\r\n    return where;\r\n  }\r\n}\r\ndecorate(MinMaxFilter, {\r\n  min: observable,\r\n  max: observable,\r\n  loaded: observable,\r\n  fieldInfo: observable,\r\n  where: computed,\r\n  load: action.bound,\r\n  onValuesChange: action.bound,\r\n  clear: action.bound\r\n})\r\n\r\nexport default MinMaxFilter;","import SelectFilter from './SelectFilter';\r\nimport { decorate, action, computed } from 'mobx';\r\nimport {getMultiSelectWhere} from '../../utils/Utils';\r\n\r\nclass MultiSelectFilter extends SelectFilter{\r\n  \r\n  type = 'multiselect';\r\n  selectValue = [];\r\n\r\n  // Used for directly setting the selected value array\r\n  onValueChange(v){\r\n    this.selectValue = v;\r\n    console.log(v);\r\n  }\r\n\r\n  // Used for setting whether an individual option is selected\r\n  onValueOptionChange(option){\r\n    if(!option) return;\r\n    if(this.selectedOptionSet.has(option)){\r\n      this.selectValue = this.selectValue.slice().filter(s => s !== option);\r\n    } else {\r\n      this.selectValue.push(option);\r\n    }\r\n  }\r\n\r\n  clear(){\r\n    this.selectValue = [];\r\n  }\r\n  \r\n  get where(){\r\n    return getMultiSelectWhere(this.field, this.selectValue, this.fieldInfo.type);\r\n  }\r\n\r\n  get selectedOptionSet(){\r\n    return new Set(this.selectValue);\r\n  }\r\n\r\n};\r\n\r\ndecorate(MultiSelectFilter, {\r\n  onValueChange: action.bound,\r\n  clear: action.bound,\r\n  where: computed,\r\n  selectedOptionSet: computed\r\n})\r\n\r\nexport default MultiSelectFilter;","import MultiSelectFilter from './MultiSelectFilter';\r\nimport { getMinMaxWhere } from '../../utils/Utils';\r\nimport { decorate, action, computed, observable } from 'mobx';\r\n\r\nclass QuantileFilter extends MultiSelectFilter{\r\n  type = 'quantile';\r\n  options = [];\r\n  \r\n  constructor(fieldName, params=null){\r\n    super(fieldName, params);\r\n    this.quantiles = params.quantiles;\r\n    if(!this.quantiles){\r\n      throw new Error(\"Please provide quantile breaks\")\r\n    }\r\n  }\r\n\r\n  load(featureLayer){\r\n    // we're not doing anything because these are hardcoded for now!\r\n    super.setFieldInfoFromLayer(featureLayer);\r\n    this.loaded = true;\r\n    this.options = this.quantiles.map(q => q.label);\r\n    this.selectValue = this.options.slice();\r\n    this.labelMap = new Map();\r\n    this.quantiles.forEach(q => this.labelMap.set(q.label, q));\r\n  }\r\n\r\n  clear(){\r\n    this.selectValue = this.options.slice();\r\n  }\r\n\r\n  get where(){\r\n    if(this.options.length === this.selectValue.length) return null;\r\n    let min, max;\r\n    for(let i = 0; i < this.selectValue.length; i++){\r\n      const label = this.selectValue[i];\r\n      const q = this.labelMap.get(label);\r\n      min = (q.min !== undefined && (min === undefined || q.min < min))\r\n        ? q.min\r\n        : min;\r\n      max = (q.max !== undefined && (max === undefined || q.max > max))\r\n        ? q.max\r\n        : max;\r\n    }\r\n    console.log(min, max);\r\n    return getMinMaxWhere(this.field, min, max);\r\n  }\r\n\r\n  get displayOptions(){\r\n    return this.options.slice();\r\n  }\r\n\r\n}\r\n\r\ndecorate(QuantileFilter, {\r\n  options: observable,\r\n  load: action.bound,\r\n  where: computed,\r\n  displayOptions: computed,\r\n  clear: action.bound\r\n})\r\n\r\nexport default QuantileFilter;","import {decorate, observable, action, computed, autorun} from 'mobx';\r\nimport {\r\n  MinMaxFilter,\r\n  MultiSelectFilter,\r\n  SelectFilter,\r\n  QuantileFilter\r\n} from './Filters';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../config/esri-loader-options';\r\nimport { message } from 'antd';\r\n\r\nlet pUtils;\r\n// can we keep this at the top? I find it intrusive in the middle?\r\nmessage.config({\r\n  top: 75,\r\n});\r\n\r\nclass Store {\r\n\r\n  credential = {};\r\n  aliasMap = null;\r\n  chartResultMap = new Map();\r\n  map = null;\r\n  layerVisibleMap = new Map();\r\n  tooltipResults = null;\r\n  bookmarkInfo = null;\r\n\r\n  constructor(appState, storeConfig){\r\n    this.appState = appState;\r\n    this.layerId = storeConfig.layerItemId;\r\n    this.mapId = storeConfig.webmapId;\r\n    this.filters = storeConfig.filters.map(f => {\r\n      switch(f.type){\r\n        case 'minmax':\r\n          return new MinMaxFilter(f.name, f.params)\r\n        case 'multiselect':\r\n          return new MultiSelectFilter(f.name, f.params);\r\n        case 'select':\r\n          return new SelectFilter(f.name, f.params);\r\n        case 'quantile':\r\n          return new QuantileFilter(f.name, f.params);\r\n        default:\r\n          throw new Error(\"Unknown filter type!\")\r\n      }\r\n    });\r\n    this.charts = storeConfig.charts || [];\r\n    \r\n    this.renderers = storeConfig.renderers;\r\n    this.rendererOptions = [...Object.keys(this.renderers)];\r\n    this.rendererField = storeConfig.initialRendererField;\r\n    this.popupTemplate = storeConfig.popupTemplate;\r\n    this.layerLoaded = false;\r\n    this.viewConfig = storeConfig.viewConfig;\r\n    this.outFields = storeConfig.outFields;\r\n    this.hasCustomTooltip = storeConfig.hasCustomTooltip;\r\n    this.bookmarkInfos = storeConfig.bookmarkInfos;\r\n    this.geocenters = storeConfig.geocenters ? storeConfig.geocenters : [];\r\n  }\r\n  // to destroy map view, need to do `view.container = view.map = null;`\r\n  // should probably include this in the dismount\r\n  destroy(){\r\n    if(this.effectHandler) this.effectHandler();\r\n    if(this.rendererHandler) this.rendererHandler();\r\n    if(this._tooltipListener) this._tooltipListener.remove();\r\n  }\r\n\r\n  loadFilters(){\r\n    this.filters.forEach(f => f.load(this.lyr, this.view));\r\n  }\r\n\r\n  // todo could query the client instead of the server\r\n  // once the layerview has loaded\r\n  loadCharts(){\r\n    if(!this.charts || this.charts.length < 1) return;\r\n    this.charts.forEach(c => {\r\n      this.lyr.queryFeatures(c.queryDefinition)\r\n        .then(qRes => {\r\n          const storedResult = c.resultTransform\r\n            ? c.resultTransform(qRes)\r\n            : qRes;\r\n          this.chartResultMap.set(c.id, storedResult);\r\n        });\r\n    });\r\n  }\r\n\r\n  _loadLayers(){\r\n    this.view.whenLayerView(this.lyr)\r\n    .then(lV => {\r\n      message.destroy();\r\n      this.lyrView = lV;\r\n      this.loadFilters();\r\n      this.loadCharts();\r\n\r\n      this.map.layers.forEach(l => {\r\n        this.layerVisibleMap.set(l.id, l.visible);\r\n      })\r\n\r\n      if(this.hasCustomTooltip){\r\n        this._tooltipListener = this.view.on(\"pointer-move\", this._onMouseMove);\r\n      }\r\n\r\n      this.aliasMap = this.lyr.fields.reduce((p, f) => {\r\n        p.set(f.name, f.alias);\r\n        return p;\r\n      }, new Map());\r\n      this.layerLoaded = true;\r\n    })\r\n    .catch(er => {\r\n      message.destroy();\r\n      message.error('Error loading the layers, does your account have access to the data?', 4);\r\n      console.log(er);\r\n    });\r\n  }\r\n\r\n  _buildAutoRunEffects(){\r\n    const onApplyFilter = pUtils.debounce(function(layerView, where){\r\n      layerView.filter = {where}\r\n      // layerView.effect = {\r\n      //   filter: {where},\r\n      //   excludedEffect: \"grayscale(50%) opacity(30%)\"\r\n      // };\r\n    });\r\n    this.effectHandler = autorun(_ => {\r\n      const where = this.where;\r\n      if(this.lyrView && onApplyFilter){\r\n        onApplyFilter(this.lyrView, where);\r\n      }\r\n    });\r\n    this.rendererHandler = autorun(_ => {\r\n      const rendererField = this.rendererField;\r\n      if(!this.lyr) return;\r\n      const renderer = this.renderers[rendererField];\r\n      if(renderer._type === 'jsapi') {\r\n        this.lyr.renderer = renderer;\r\n        return;\r\n      } \r\n      loadModules(['esri/renderers/support/jsonUtils'], options)\r\n        .then(([rendererJsonUtils]) => {\r\n          this.lyr.renderer = rendererJsonUtils.fromJSON(this.renderers[rendererField]);\r\n        });\r\n    })\r\n  }\r\n\r\n  // class to watch for mouse movement\r\n  // need to figure learn how best to use this debounce function\r\n  _onMouseMove(evt){\r\n\r\n    const handleEvt = pUtils.debounce(function(classRef, event){\r\n      return classRef.view.hitTest(event)\r\n        .then(hit => {\r\n          if(classRef._tooltipHighlight){\r\n            classRef._tooltipHighlight.remove();\r\n            classRef._tooltipHighlight = null;\r\n          }\r\n          const results = hit.results.filter(r => r.graphic.layer === classRef.lyr);\r\n          if(results.length){\r\n            const graphic = results[results.length - 1].graphic;\r\n            const screenPoint = hit.screenPoint;\r\n            classRef._tooltipHighlight = classRef.lyrView.highlight(graphic);\r\n            classRef.tooltipResults = {\r\n              screenPoint,\r\n              graphic\r\n            }\r\n          } else {\r\n            classRef.tooltipResults = null;\r\n          }\r\n        })\r\n    })\r\n    handleEvt(this, evt)\r\n  }\r\n\r\n  setRendererField(field){\r\n    this.rendererField = field;\r\n  }\r\n\r\n  toggleLayerVisibility(layer){\r\n    // console.log(layer);\r\n    const isVisible = !layer.visible;\r\n    layer.visible = isVisible;\r\n    this.layerVisibleMap.set(layer.id, isVisible);\r\n  }\r\n\r\n  load(mapViewDiv){\r\n    message.loading('Loading data.', 0);\r\n    let renderer;\r\n    return loadModules([\r\n      'esri/WebMap',\r\n      'esri/Map',\r\n      'esri/views/MapView',\r\n      'esri/layers/FeatureLayer',\r\n      'esri/core/promiseUtils',\r\n      'esri/identity/IdentityManager',\r\n      'esri/renderers/support/jsonUtils',\r\n      'esri/geometry/SpatialReference'\r\n    ], options)\r\n    .then(([WebMap, Map, MapView, FeatureLayer, promiseUtils, esriId, rendererJsonUtils, SpatialReference]) => {\r\n\r\n      esriId.registerToken(this.appState.session.toCredential());\r\n\r\n      pUtils = promiseUtils;\r\n      this._buildAutoRunEffects();\r\n\r\n      if(this.renderers && this.renderers[this.rendererField]){\r\n        renderer = this.renderers[this.rendererField]._type === 'jsapi'\r\n          ? this.renderers[this.rendererField]\r\n          : rendererJsonUtils.fromJSON(this.renderers[this.rendererField]);\r\n      }\r\n\r\n      this.view = new MapView({\r\n        container: mapViewDiv,\r\n        center: this.viewConfig.center,\r\n        zoom: this.viewConfig.zoom,\r\n        //spatialReference: SpatialReference.WGS84\r\n        //spatialReference: new SpatialReference({ wkid: 4326 })\r\n      })\r\n\r\n      if(this.mapId){\r\n        this.map = new WebMap({\r\n          portalItem: {\r\n            id: this.mapId\r\n          }\r\n        });\r\n        this.view.map = this.map;\r\n        return this.map.when();\r\n      } else {\r\n        const lyr = new FeatureLayer({\r\n          portalItem: {id: this.layerId}\r\n        })\r\n        this.map = new Map({\r\n          basemap: 'dark-gray-vector',\r\n          layers: [lyr]\r\n        });\r\n        this.view.map = this.map;\r\n        return Promise.resolve();\r\n      }\r\n\r\n    })\r\n    .then(_ => {\r\n      this.lyr = this.map.layers.find(l => \r\n        l.portalItem.id === this.layerId\r\n      );\r\n      if(renderer) this.lyr.renderer = renderer;\r\n      if(this.outFields) this.lyr.outFields = this.outFields;\r\n      if(this.popupTemplate !== undefined) this.lyr.popupTemplate = this.popupTemplate;\r\n      this._loadLayers();\r\n      return this.view;\r\n    })\r\n    .catch(er => {\r\n      message.destroy();\r\n      message.error('Error creating the map, please refresh for now');\r\n    });\r\n  }\r\n\r\n  clearFilters(){\r\n    this.filters.forEach(f => f.clear());\r\n  }\r\n\r\n  //todo, move the GoTo to the view?\r\n  onBookmarkClick(index){\r\n    if(!this.view || index >= this.bookmarks.length) return;\r\n    const bookmark = this.bookmarks[index];\r\n    this.view.goTo(bookmark.extent);\r\n    if(this.bookmarkInfos){\r\n      console.log('bookmark setting', bookmark.name)\r\n      this.bookmarkInfo = this.bookmarkInfos[bookmark.name]\r\n    }\r\n  }\r\n\r\n  onGeocenterClick(index) {\r\n    if(!this.view || index >= this.geocenters.length) return;\r\n    const geocenter = this.geocenters[index];\r\n    this.view.goTo(geocenter.extent);\r\n  }\r\n\r\n\r\n  onClearBookmark(){\r\n    this.bookmarkInfo = null;\r\n  }\r\n\r\n  get where(){\r\n    const where = this.filters\r\n      .filter(f => !!f.where)\r\n      .map(f => f.where)\r\n      .join(' AND '); \r\n    return where ? where : \"1=1\";\r\n  }\r\n  \r\n  get layers(){\r\n    if(this.map && this.layerLoaded) {\r\n      return this.map.layers.items.reverse();\r\n    };\r\n    return [];\r\n  }\r\n\r\n  get bookmarks(){\r\n    if(this.map && this.layerLoaded) {\r\n      return this.map.bookmarks.items;\r\n    };\r\n    return [];\r\n  }\r\n}\r\n\r\ndecorate(Store, {\r\n  user: observable,\r\n  rendererField: observable,\r\n  layerLoaded: observable,\r\n  aliasMap: observable,\r\n  layerVisibleMap: observable,\r\n  chartResultMap: observable.shallow,\r\n  tooltipResults: observable.shallow,\r\n  bookmarkInfo: observable.ref,\r\n  map: observable.ref,\r\n  where: computed,\r\n  layers: computed,\r\n  bookmarks: computed,\r\n  load: action.bound,\r\n  _loadLayers: action.bound,\r\n  loadFilters: action.bound,\r\n  loadCharts: action.bound,\r\n  setRendererField: action.bound,\r\n  clearFilters: action.bound,\r\n  toggleLayerVisibility: action.bound,\r\n  _onMouseMove: action.bound,\r\n  onBookmarkClick: action.bound,\r\n  onClearBookmark: action.bound\r\n});\r\n\r\nexport default Store;","import {decorate, observable, action } from 'mobx';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../config/esri-loader-options';\r\nimport Store from '../stores/Store';\r\nimport { message } from 'antd';\r\n\r\nmessage.config({\r\n  // top: \"calc(100vh - 70px)\"\r\n  top: \"75px\"\r\n})\r\n\r\nconst scoreStatQuery = {\r\n  onStatisticField: 'eventvalue',\r\n  outStatisticFieldName: 'score_sum',\r\n  statisticType: 'sum'\r\n}\r\n\r\nclass SafetyStore extends Store {\r\n  editMode = null;\r\n  startGraphic = null;\r\n  endGraphic = null;\r\n  startStr = '';\r\n  endStr = '';\r\n  isSketchLoaded = false;\r\n\r\n  stdRoute = null;\r\n  stdTravelTime = null;\r\n  stdTravelScore = null;\r\n  scoreRoute = null;\r\n  safetyTravelTime = null;\r\n  safetyTravelScore = null;\r\n\r\n  load(mapViewDiv){\r\n    return super.load(mapViewDiv)\r\n      .then(view => {\r\n        loadModules([\r\n          'esri/widgets/Sketch/SketchViewModel',\r\n          'esri/layers/FeatureLayer',\r\n          'esri/geometry/SpatialReference'\r\n        ], options)\r\n          .then(([SketchVM, FeatureLayer, SpatialReference]) => {\r\n            this.sketchVM = new SketchVM({\r\n              view,\r\n              layer: view.graphics\r\n            });\r\n            this.sketchListener = this.sketchVM.on(\"create\", this.onCreateComplete);\r\n            this.isSketchLoaded = true;\r\n\r\n            this.routeResultLyr = new FeatureLayer({\r\n              title: \"Route Results\",\r\n              geometryType: \"polyline\",\r\n              spatialReference: SpatialReference.WebMercator,\r\n              //spatialReference: SpatialReference.WGS84,\r\n              objectIdField: 'oid',\r\n              source: []\r\n            })\r\n            this.map.add(this.routeResultLyr);\r\n          });\r\n        return view;\r\n      })\r\n  }\r\n\r\n  clearRouteData(){\r\n    if(this.startGraphic){\r\n      this.view.graphics.remove(this.startGraphic);\r\n      this.startGraphic = null;\r\n    }\r\n    if(this.endGraphic){\r\n      this.view.graphics.remove(this.endGraphic);\r\n      this.endGraphic = null;\r\n    }\r\n    if(this.stdRoute){\r\n      this.view.graphics.remove(this.stdRoute);\r\n      this.stdRoute = null;\r\n    }\r\n    if(this.scoreRoute){\r\n      this.view.graphics.remove(this.scoreRoute);\r\n      this.scoreRoute = null;\r\n    }\r\n    this.editMode = null;\r\n    this.startStr = '';\r\n    this.endStr = '';\r\n    this.stdTravelTime = null;\r\n    this.stdTravelScore = null;\r\n    this.safetyTravelTime = null;\r\n    this.safetyTravelScore = null;\r\n  }\r\n\r\n  onCreateComplete(evt){\r\n    if(evt.state !== 'complete') return;\r\n    if(this.editMode === 'start'){\r\n      this.startGraphic = evt.graphic;\r\n      this.setAddressFromGeocode('start', this.startGraphic);\r\n    } else if (this.editMode === 'end'){\r\n      this.endGraphic = evt.graphic;\r\n      this.setAddressFromGeocode('end', this.endGraphic);\r\n    } else {\r\n      this.view.graphics.remove(evt.graphic);\r\n    }\r\n    if(this.startGraphic && this.endGraphic){\r\n      this.view.goTo([this.startGraphic, this.endGraphic])\r\n    }\r\n  }\r\n\r\n  setAddressFromGeocode(stopType, graphic){\r\n\r\n    loadModules(['esri/tasks/Locator'], options)\r\n      .then(([Locator]) => {\r\n        const locator = new Locator({\r\n          url: \"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer\"\r\n        });\r\n        return locator.locationToAddress({\r\n          location: graphic.geometry,\r\n          locationType: \"street\"\r\n        });\r\n      })\r\n      .then(res => {\r\n        if(stopType === 'start') this.startStr = res.address;\r\n        else if(stopType === 'end') this.endStr = res.address;\r\n      })\r\n      .catch(er => {\r\n        message.error('Error converting point to an address, please retry!')\r\n      });\r\n  }\r\n\r\n  // don't like this logic, re-write at some point #refactor!\r\n  onCreateClick(e){\r\n    if(e === 'start' && this.startGraphic){\r\n      this.view.graphics.remove(this.startGraphic);\r\n      this.startGraphic = null;\r\n      this.editMode = e;\r\n      this.startStr = '';\r\n    }\r\n    if(e === 'end' && this.endGraphic){\r\n      this.view.graphics.remove(this.endGraphic);\r\n      this.endGraphic = null;\r\n      this.editMode = e;\r\n      this.endStr = '';\r\n    }\r\n    if(this.editMode === e){\r\n      this.editMode = null;\r\n      if(this.sketchVM.state === 'active') {\r\n        this.sketchVM.cancel();\r\n      }\r\n    } else {\r\n      this.sketchVM.create(\"point\");\r\n      this.editMode = e;\r\n    }\r\n  }\r\n\r\n  generateStdRoute(){\r\n    return loadModules([\r\n      'esri/tasks/RouteTask',\r\n      'esri/tasks/support/RouteParameters',\r\n      'esri/tasks/support/FeatureSet',\r\n      'esri/geometry/SpatialReference'\r\n    ], options)\r\n    .then(([\r\n      RouteTask,\r\n      RouteParameters,\r\n      FeatureSet,\r\n      SpatialReference\r\n    ]) => {\r\n      const routeTask = new RouteTask({\r\n        url: \"https://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/solve\"\r\n      });\r\n  \r\n      const routeParams = new RouteParameters({\r\n        stops: new FeatureSet(),\r\n        outSpatialReference: SpatialReference.WebMercator,\r\n        impedanceAttribute: 'Miles',\r\n        accumulateAttributes: ['TravelTime']\r\n      });\r\n  \r\n      routeParams.stops.features.push(this.startGraphic);\r\n      routeParams.stops.features.push(this.endGraphic);\r\n  \r\n      return routeTask.solve(routeParams)\r\n    })\r\n    .then(data => {\r\n      // console.log('std', data);\r\n      \r\n      // const existingGraphic = this.routeResultLyr.source.find(f => f.attributes.oid === 1);\r\n      // if(existingGraphic){\r\n      //   this.routeResultLyr.source.remove(existingGraphic);\r\n      // }\r\n      // const nextRoute = data.routeResults[0].route;\r\n\r\n      if(this.stdRoute) this.view.graphics.remove(this.stdRoute);\r\n      this.stdRoute = data.routeResults[0].route;\r\n      this.stdRoute.symbol = {\r\n        type: \"simple-line\",\r\n        color: [94, 43, 255, 1],\r\n        width: 3\r\n      };\r\n      this.stdTravelTime = this.stdRoute.attributes['Total_TravelTime'];\r\n      this.view.graphics.add(this.stdRoute);\r\n      return this.lyrView.queryFeatures({\r\n        where: \"1=1\",\r\n        geometry: this.stdRoute.geometry,\r\n        outStatistics: [scoreStatQuery]\r\n      })\r\n    })\r\n    .then(res => {\r\n      if(res.features && res.features.length){\r\n        this.stdTravelScore = res.features[0].attributes['score_sum']\r\n      }\r\n    });\r\n  }\r\n\r\n  generateScoreRoute(){\r\n\r\n    const pQuery = this.lyrView.queryFeatures({\r\n      where: \"eventvalue > 0\",\r\n      geometry: this.view.extent,\r\n      spatialRelationship: 'contains',\r\n      orderByFields: ['eventvalue DESC'],\r\n      returnGeometry: true,\r\n      outFields: ['eventvalue', 'OBJECTID']\r\n    });\r\n\r\n    const pModules = loadModules([\r\n      'esri/tasks/RouteTask',\r\n      'esri/tasks/support/RouteParameters',\r\n      'esri/tasks/support/FeatureSet',\r\n      'esri/geometry/SpatialReference',\r\n      \"esri/geometry/geometryEngine\"\r\n    ], options);\r\n\r\n    return Promise.all([pQuery, pModules])\r\n    .then(([\r\n      qres,\r\n      [ RouteTask, RouteParameters, FeatureSet, SpatialReference,geometryEngine]\r\n    ]) => {\r\n\r\n      const routeTask = new RouteTask({\r\n        url: \"https://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/solve\"\r\n      });\r\n  \r\n      const routeParams = new RouteParameters({\r\n        stops: new FeatureSet(),\r\n        polygonBarriers: new FeatureSet(),\r\n        outSpatialReference: SpatialReference.WebMercator,\r\n        impedanceAttribute: 'Miles',\r\n        accumulateAttributes: ['TravelTime']\r\n      });\r\n  \r\n      routeParams.stops.features.push(this.startGraphic);\r\n      routeParams.stops.features.push(this.endGraphic);\r\n\r\n      var scorepolys = qres.features.slice(0,150).map((f,i) => {\r\n        var scorebuffer = {\r\n          geometry: geometryEngine.geodesicBuffer(f.geometry, 15, \"meters\"),\r\n          attributes: {\r\n            Name: f.attributes['ObjectId'],\r\n            BarrierType: 1,\r\n            Attr_Miles: f.attributes['eventvalue'] / 4\r\n          },\r\n        }\r\n        return scorebuffer;  \r\n      });\r\n      routeParams.polygonBarriers.features = scorepolys;\r\n\r\n      return routeTask.solve(routeParams)\r\n    })\r\n    .then(data => {\r\n      console.log('score', data);\r\n      if(this.scoreRoute) this.view.graphics.remove(this.scoreRoute);\r\n      this.scoreRoute = data.routeResults[0].route;\r\n      this.scoreRoute.symbol = {\r\n        type: \"simple-line\",\r\n        color: [227, 69, 143, 1],\r\n        width: 3\r\n      };\r\n      this.safetyTravelTime = this.scoreRoute.attributes['Total_TravelTime'];\r\n      this.view.graphics.add(this.scoreRoute);\r\n      return this.lyrView.queryFeatures({\r\n        where: \"1=1\",\r\n        geometry: this.scoreRoute.geometry,\r\n        outStatistics: [scoreStatQuery]\r\n      })\r\n    })\r\n    .then(res => {\r\n      if(res.features && res.features.length){\r\n        this.safetyTravelScore = res.features[0].attributes['score_sum']\r\n      }\r\n    });\r\n  }\r\n\r\n  // todo refactor to add to map and zoom to the extents then query data\r\n  generateRoutes(){\r\n    message.loading('Generating routes!', 0);\r\n    loadModules([\r\n      'esri/tasks/RouteTask',\r\n      'esri/tasks/support/RouteParameters',\r\n      'esri/tasks/support/FeatureSet',\r\n      'esri/geometry/SpatialReference'\r\n    ], options)\r\n    .then(_ => \r\n      Promise.all([\r\n        this.generateStdRoute(),\r\n        this.generateScoreRoute()\r\n      ])\r\n    )\r\n    .then( _ => {\r\n      this.view.goTo([this.scoreRoute, this.stdRoute]);\r\n      message.destroy();\r\n    })\r\n    .catch(_ => {\r\n      message.destroy();\r\n      message.error('Error generating routes, please retry!');\r\n    })\r\n\r\n  }\r\n\r\n  get safetyScoreDelta(){\r\n    if(!this.stdTravelScore || !this.safetyTravelScore){\r\n      return null;\r\n    }\r\n    return 100 * ((this.safetyTravelScore - this.stdTravelScore) / this.stdTravelScore);\r\n  }\r\n\r\n  get safetyTimeDelta(){\r\n  if(!this.stdTravelTime || !this.safetyTravelTime){\r\n    return null;\r\n  }\r\n  return 100 * ((this.safetyTravelTime - this.stdTravelTime) / this.stdTravelTime);\r\n}\r\n\r\n}\r\n\r\ndecorate(SafetyStore, {\r\n  editMode: observable,\r\n  startGraphic: observable,\r\n  endGraphic: observable,\r\n  startStr: observable,\r\n  endStr: observable,\r\n  isSketchLoaded: observable,\r\n  stdTravelTime: observable,\r\n  safetyTravelTime: observable,\r\n  stdTravelScore: observable,\r\n  safetyTravelScore: observable,\r\n  onStartClick: action.bound,\r\n  onEndClick: action.bound,\r\n  load: action.bound,\r\n  onCreateComplete: action.bound,\r\n  setAddressFromGeocode: action.bound,\r\n  generateRoutes: action.bound,\r\n  generateStdRoute: action.bound,\r\n  clearRouteData: action.bound\r\n})\r\n\r\nexport default SafetyStore;","// for now expect exactly 5 stops that map to the same color ramp\r\nconst getRenderer = (field, stops,labels) => ({\r\n  _type: \"jsapi\",\r\n  type: \"simple\",\r\n  symbol: { type: \"simple-line\" ,width: \"2.5px\"},\r\n  label: \"Road segment\",\r\n  visualVariables: [{\r\n    type: \"color\",\r\n    field,\r\n    stops: [\r\n      { value: stops[0], color: [44,123,182,255], label: `${labels[0]}` },\r\n      { value: stops[1], color: [171,217,233,255], label: null },\r\n      { value: stops[2], color: [255,255,191,255], label: `${labels[1]}` },\r\n      { value: stops[3], color: [253,174,97,255], label: null },\r\n      { value: stops[4], color: [215,25,28,255], label: `${labels[2]}`},\r\n    ]\r\n  }]\r\n})\r\n\r\nconst safetyConfig = {\r\n  //layerItemId: '534f26d211154527b31c976ea6b5eafe',\r\n  layerItemId: 'e37cc788804e4303b6e7898481798691',\r\n  webmapId: '906b58f399944774a29e05d3d24a939b',\r\n  // webmapId: '58d18243967d40e9a25db1f02d3652b0',\r\n  initialRendererField: 'eventvalue',\r\n  renderers: {\r\n    'eventvalue': {\r\n      _type: \"jsapi\",\r\n      type: 'class-breaks',\r\n      field: 'eventvalue',\r\n      classBreakInfos: [{\r\n        minValue: 0,\r\n        maxValue: 2.499,\r\n        symbol: {type: \"simple-line\", width: \"2.5px\", color: [171,217,233,255]},\r\n        label: \"Low\"\r\n      }, {\r\n        minValue: 2.5,\r\n        maxValue: 5.6453,\r\n        symbol: {type: \"simple-line\", width: \"2.5px\", color: [255,255,191,255]},\r\n        label: \"Average\"\r\n      }, {\r\n        minValue: 5.6454,\r\n        maxValue: 12.499,\r\n        symbol: {type: \"simple-line\", width: \"2.5px\", color: [253,174,97,255]},\r\n        label: \"High\"\r\n      }, {\r\n        minValue: 12.5,\r\n        maxValue: 1000,\r\n        symbol: {type: \"simple-line\", width: \"2.5px\", color: [215,25,28,255]},\r\n        label: \"Very High\"\r\n      }]\r\n    },\r\n    'harsh_acc_ratio': getRenderer('harsh_acc_ratio', [0,3.5,7,10.5,14],['Low','Medium','High']),\r\n    'harsh_cornering_ratio': getRenderer('harsh_cornering_ratio', [0,1.86,3.7,5.56,7.4],['Low','Medium','High']),\r\n    'pedestrians_density': getRenderer('pedestrians_density', [0,0.3,0.61,0.9,1.2],['Low','Medium','High']),\r\n    'bicycles_density': getRenderer('bicycles_density', [0,0.056,0.112,0.166,0.22],['Low','Medium','High']),\r\n    'speeding_ratio': getRenderer('speeding_ratio', [0,3.7,7.5,11.2,15],['Low','Medium','High']),\r\n    'avarge_speed': getRenderer('avarge_speed',[28,38,48,58,68],['< 25','50','> 70']),\r\n    'pcw': getRenderer('pcw', [0,0.01181361,0.02357791,0.03498221,0.05745235],['Low','Medium','High']),\r\n     'fcw': getRenderer('fcw', [0,1.35499499,2.66894309,6.03785078,8.2561676],['Low','Medium','High'])\r\n  },\r\n  filters: [{\r\n    name:'eventvalue',\r\n    type: 'quantile',\r\n    params: {\r\n      quantiles: [{\r\n        min: 0,\r\n        max: 2.5,\r\n        // label: \"Low (30%)\",\r\n        label: \"Low\"\r\n      }, {\r\n        min: 2.5,\r\n        max: 5.6453,\r\n        // label: \"Average (40%)\",\r\n        label: \"Average\"\r\n      }, {\r\n        min: 5.6453,\r\n        max: 12.5,\r\n        // label: \"High (20%)\"\r\n        label: \"High\"\r\n      }, {\r\n        min: 12.5,\r\n        max: 1000,\r\n        // label: \"Very High (10%)\"\r\n        label: \"Very High\"\r\n      }],\r\n      info: \"Road risk score based on the variables below.\",\r\n      style: \"buttons\"\r\n    }\r\n  },{\r\n    name: 'harsh_acc_ratio',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Percentage of cars that brake harshly in the segment.\"\r\n    }\r\n  },{\r\n    name: 'harsh_cornering_ratio',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Percentage of cars that turn the corner with high G-force.\"\r\n    }\r\n  },{\r\n    name: 'pedestrians_density',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Density of pedestrians over the segment.\"\r\n    }\r\n  },{\r\n    name: 'bicycles_density',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Density of bicycles over the segment.\"\r\n    }\r\n  },{\r\n    name: 'speeding_ratio',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"The percentage of vehicles that drive a standard deviation above the average speed at the segment.\"\r\n    }\r\n  },{\r\n    name: 'avarge_speed',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: '0',\r\n      upperBoundLabel: '140',\r\n      info: \"Average speed of the respective segment. (Does not contribute to risk score on its own).\"\r\n    }\r\n  },{\r\n    name: 'pcw',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Pedestrian and cyclist collision warning (PCW)\"\r\n    }\r\n  },{\r\n    name: 'fcw',\r\n    type: 'minmax',\r\n    params: {\r\n      isLogarithmic: false,\r\n      hasHistograms: false,\r\n      lowerBoundLabel: 'low',\r\n      upperBoundLabel: 'high',\r\n      info: \"Forward collision warning (FCW)\"\r\n    }\r\n  }],\r\n  hasCustomTooltip: true,\r\n  outFields: [\r\n    'eventvalue', 'harsh_cornering_ratio', 'harsh_acc_ratio', 'pedestrians_density',\r\n    'bicycles_density', 'speeding_ratio', 'avarge_speed','pcw','fcw'\r\n  ], \r\n  popupTemplate: null,\r\n  //for n\r\n  // popupTemplate: {\r\n  //   title: \"Road Segment Information\",\r\n  //   content: [{\r\n  //     type: \"text\",\r\n  //     text: \"<b>Road Risk Score: {expression/round_score}</b>\",\r\n  //   }, {\r\n  //     type: \"fields\",\r\n  //     fieldInfos: [{\r\n  //       fieldName: 'harsh_cornering_ratio',\r\n  //       label: 'Harsh cornering (%)',\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }, {\r\n  //       fieldName: 'harsh_acc_ratio',\r\n  //       label: \"Harsh braking (%)\",\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }, {\r\n  //       fieldName: 'pedestrians_density',\r\n  //       label: \"Average pedestrian volume\",\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }, {\r\n  //       fieldName: 'bicycles_density',\r\n  //       label: 'Average cyclist volume',\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }, {\r\n  //       fieldName: 'speeding_ratio',\r\n  //       label: 'Above average speeds (%)',\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }, {\r\n  //       fieldName: 'avarge_speed',\r\n  //       label: 'Average speed (Km/H)',\r\n  //       format: {\r\n  //         places: 2,\r\n  //         digitSeparator: true\r\n  //       },\r\n  //     }]\r\n  //   }],\r\n  //   expressionInfos: [{\r\n  //     name: \"round_score\",\r\n  //     expression: \"Round($feature.eventvalue,2)\"\r\n  //   }]\r\n  // },\r\n  viewConfig: {\r\n    center: [-74.00157, 40.71955],\r\n    zoom: 12\r\n  },\r\n  bookmarkInfos: {\r\n    'Willamsburg Bridge': {\r\n      title: 'Williamsburg Bridge',\r\n      content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'\r\n    },\r\n    'Jerusalem': {\r\n      title: 'Jerusalem',\r\n      content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'\r\n    },\r\n    'Manhattan': {\r\n      title: 'Manhattan',\r\n      content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'\r\n    }\r\n  }\r\n}\r\n\r\nexport default safetyConfig;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { Card, Button } from 'antd';\r\n\r\nclass BookmarkPanelItem extends React.PureComponent {\r\n\r\n  onClick = () => {\r\n    this.props.onClick(this.props.id);\r\n  }\r\n\r\n  render(){\r\n    const b = this.props.bookmark;\r\n    return(\r\n      <Card style={{marginBottom: \"5px\"}} key={b.name}>\r\n        <h3 style={{margin: 0, display: \"inline-block\"}}>{b.name}</h3>\r\n        <Button style={{float: \"right\"}} ghost type=\"primary\" onClick={this.onClick}>Explore</Button>\r\n      </Card>\r\n    )\r\n  }\r\n}\r\n\r\nconst BookmarkPanel = observer(({store}) => {\r\n\r\n  const bookmarkViews = store.bookmarks.map((b,i) => \r\n    <BookmarkPanelItem bookmark={b} id={i} key={b.name} onClick={store.onBookmarkClick}/>\r\n  )\r\n\r\n  return(\r\n    <>\r\n      {bookmarkViews}\r\n    </>\r\n  )\r\n});\r\n\r\nexport default BookmarkPanel;\r\n\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { Card, Progress } from 'antd';\r\n\r\nimport safetyConfig from './SafetyConfig';\r\n\r\n// This is really lazy, should be a method in the store but need to adjust config too so\r\n// quantiles only get defined once\r\nconst quantiles = safetyConfig.filters.find(f => f.name === 'eventvalue').params.quantiles;\r\n\r\nconst getQuantileLabel = value => {\r\n  for(let i=0; i < quantiles.length; i++){\r\n    if(value < quantiles[i].max){\r\n      return quantiles[i].label;\r\n    }\r\n  }\r\n  return ''\r\n}\r\n\r\n\r\nconst SafetyTooltip = observer(({store}) => {\r\n\r\n  if(!store.tooltipResults){\r\n    return null;\r\n  }\r\n  const {\r\n    graphic,\r\n    screenPoint\r\n  } = store.tooltipResults;\r\n  const {x,y} = screenPoint;\r\n\r\n  const isSubsetFields = store.rendererField && store.rendererField !== 'eventvalue';\r\n\r\n  const style = {\r\n    display: 'block',\r\n    position: 'absolute',\r\n    top: isSubsetFields ? `${y - 115}px` :`${y - 405}px`,\r\n    left: `${x - 220/2}px`,\r\n    width: '220px',\r\n    height: isSubsetFields ? '110px' : '400px',\r\n    overflow: 'auto',\r\n    zIndex: '99',\r\n    pointerEvents: 'none',\r\n  }\r\n  if(!graphic) style.display = 'none';\r\n  const attrs = graphic.attributes;\r\n\r\n  const aM = store.aliasMap;\r\n  // this is weird, but the filter objects will all have queried attribute metadata\r\n  // to define information in the tooltip, and we want to show them all\r\n  // longer term may want to move this out of the filters\r\n\r\n  const infoContent = store.filters.filter(f => {\r\n    const defaultBool = attrs.hasOwnProperty(f.field) && f.type === 'minmax' && f.field !== 'eventvalue';\r\n    return isSubsetFields\r\n      ? defaultBool && store.rendererField === f.field\r\n      : defaultBool;\r\n  }).map(f => \r\n    <div key={f.field}>\r\n      {f.alias}\r\n      <Progress\r\n        percent={Math.round((attrs[f.field]/f.upperBound) * 100)}\r\n        status=\"normal\"\r\n        showInfo={false}/>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <Card className=\"antd-esri-widget\" style={style} size=\"small\" title={`${aM.get('eventvalue')}: ${getQuantileLabel(attrs['eventvalue'])}`}>\r\n      {infoContent}\r\n    </Card>\r\n  )\r\n});\r\n\r\nexport default SafetyTooltip;","import React from 'react'\r\nimport { observer } from \"mobx-react\";\r\nimport { Layout, Menu, Drawer, Icon, Row, Col, Card } from 'antd';\r\nimport LayerFilterIcon from 'calcite-ui-icons-react/LayersIcon';\r\nimport BookmarkIcon from 'calcite-ui-icons-react/BookmarkIcon';\r\nimport RouteFromIcon from 'calcite-ui-icons-react/RouteFromIcon';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../config/esri-loader-options';\r\nimport LayerPanel from './LayerPanel';\r\nimport RoutePanel from './RoutePanel';\r\nimport SafetyStore from './SafetyStore';\r\nimport safetyConfig from './SafetyConfig';\r\nimport BookmarkPanel from '../components/BookmarkPanel';\r\nimport SafetyTooltip from './SafetyTooltip';\r\nimport MobileyeLogo from '../resources/Basic_Web_White_Logo.png';\r\n\r\nconst { Header, Content, Sider } = Layout;\r\n\r\nconst MenuFilterIcon = () => (\r\n  <LayerFilterIcon size=\"18\" filled/>\r\n)\r\nconst MenuBookmarkIcon = () => (\r\n  <BookmarkIcon size=\"18\" filled/>\r\n)\r\nconst MenuRouteFromIcon = () => (\r\n  <RouteFromIcon size=\"20\" filled/>\r\n)\r\n\r\nconst SafetyApp = observer(class App extends React.Component {\r\n\r\n  state = {\r\n    collapsed: true,\r\n    loaded: false,\r\n    navKey: null\r\n  };\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.mapViewRef = React.createRef();\r\n    this.store = new SafetyStore(props.appState, safetyConfig);\r\n  }\r\n\r\n  onCollapse = collapsed => {\r\n    this.setState({ collapsed });\r\n  };\r\n\r\n  onSelect = item => {\r\n    const navKey = this.state.navKey === item.key\r\n      ? null\r\n      : item.key;\r\n    this.setState({navKey});\r\n    this.store.onClearBookmark();\r\n  }\r\n\r\n  onClose = () => {\r\n    this.setState({\r\n      navKey: null,\r\n    });\r\n    this.store.onClearBookmark();\r\n  };\r\n\r\n  onSignOutClick = () => {\r\n    this.props.appState.logout();\r\n  }\r\n\r\n  componentDidMount = () => {\r\n\r\n    const modulePromise = loadModules([\r\n      'esri/widgets/Search',\r\n      'esri/widgets/Legend'\r\n    ], options);\r\n    const loadPromise = this.store.load(this.mapViewRef.current);\r\n\r\n    Promise.all([modulePromise, loadPromise])\r\n      .then(([[Search, Legend], mapView]) => {\r\n        this.view = mapView;\r\n        const search = new Search({view: this.view});\r\n        this.view.ui.add(search, \"top-right\");\r\n        const legend = new Legend({\r\n          view: this.view,\r\n          layerInfos: [{layer: this.store.lyr, title: \"\"}]\r\n        });\r\n        this.view.popup.actions.removeAll();\r\n        this.view.ui.add(legend, \"bottom-right\");\r\n        this.view.ui.move(\"zoom\", \"top-right\");\r\n\r\n      })\r\n  }\r\n\r\n  render() {\r\n\r\n    let panel;\r\n    switch(this.state.navKey){\r\n      case 'Data Layers':\r\n        panel = <LayerPanel store={this.store}/>;\r\n        break;\r\n      case 'Saved Locations':\r\n        panel = <BookmarkPanel store={this.store}/>\r\n        break;\r\n      case 'Route':\r\n        panel = <RoutePanel store={this.store}/>\r\n        break;\r\n      default:\r\n        panel = null;\r\n    }\r\n\r\n    const signin = this.props.appState.displayName\r\n      ? (\r\n        <Menu\r\n          // theme=\"dark\"\r\n          mode=\"horizontal\"\r\n          style={{ lineHeight: '64px', float: \"right\" }}\r\n        >\r\n          <Menu.Item key=\"sign in\" onClick={this.onSignOutClick}>\r\n            <Icon type=\"logout\"/>\r\n            {this.props.appState.displayName}\r\n          </Menu.Item>\r\n        </Menu>\r\n      )\r\n      : null;\r\n      \r\n    const tooltip = this.store.hasCustomTooltip\r\n      ? <SafetyTooltip store={this.store}/>\r\n      : null;\r\n    \r\n    \r\n    let bookmarkCard;\r\n    if(this.store.bookmarkInfo){\r\n      bookmarkCard = (\r\n        <Card\r\n          title={this.store.bookmarkInfo.title}\r\n          className=\"antd-esri-widget\"\r\n          style={{\r\n            position: \"absolute\",\r\n            bottom: \"30px\",\r\n            width: \"400px\",\r\n            left: \"50%\",\r\n            marginLeft: \"-200px\",\r\n          }}\r\n          size=\"small\">\r\n          {this.store.bookmarkInfo.content}\r\n        </Card>\r\n      )\r\n    }\r\n    return (\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <Sider collapsible collapsed={this.state.collapsed} onCollapse={this.onCollapse}>\r\n          <img\r\n            src={MobileyeLogo}\r\n            alt=\"Mobileye Logo\"\r\n            style={{height: \"40px\", margin: \"12px\"}}\r\n            />\r\n          <Menu\r\n            defaultSelectedKeys={['0']}\r\n            mode=\"inline\"\r\n            theme=\"dark\"\r\n            selectedKeys={[this.state.navKey]}\r\n            onClick={this.onSelect}>\r\n            <Menu.Item key=\"Data Layers\">\r\n              <Icon component={MenuFilterIcon} />\r\n              <span>Data Layers</span>\r\n            </Menu.Item>\r\n            <Menu.Item key=\"Route\">\r\n              <Icon component={MenuRouteFromIcon} />\r\n              <span>Route</span>\r\n            </Menu.Item>\r\n            <Menu.Item key=\"Saved Locations\">\r\n              <Icon component={MenuBookmarkIcon} />\r\n              <span>Saved Locations</span>\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Sider>\r\n        <Layout>\r\n          <Header style={{paddingLeft: \"1rem\", paddingRight: \"0rem\", background: \"white\"}}>\r\n            <h1 style={{float: \"left\"}}>Road Risk Score&nbsp;&nbsp;  </h1>\r\n            <div style={{float: \"left\"}}> (Data presented from Sep 1st - October 22nd)</div>\r\n            {signin}\r\n          </Header>\r\n          <Content>\r\n            <Row>\r\n              <Col\r\n                span={24}\r\n                style={{height: \"calc(100vh - 64px)\"}}>\r\n              <div\r\n                ref={this.mapViewRef}\r\n                style={{width: \"100%\", height: \"100%\"}}/>\r\n              {tooltip}\r\n              {bookmarkCard}\r\n              <Drawer\r\n                title={this.state.navKey}\r\n                closable={true}\r\n                onClose={this.onClose}\r\n                placement=\"left\"\r\n                visible={this.state.navKey}\r\n                mask={false}\r\n                width={340}\r\n                getContainer={false}\r\n                style={{ position: 'absolute', background: \"#f5f5f5\", height: \"calc(100% - 15px)\"}}\r\n                bodyStyle={{ padding: \"10px\", background: \"#f5f5f5\", minHeight: \"calc(100% - 55px)\"}}\r\n              >\r\n                {panel}\r\n              </Drawer>\r\n            </Col>\r\n            </Row>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n});\r\n\r\nexport default SafetyApp;","// update to map\r\n\r\nimport bicycleImage from '../resources/images/ET_BICYCLE.png'\r\nimport pedImage from '../resources/images/ET_PED_ON_HW.png'\r\n\r\nconst eventsConfig = {\r\n  layerItemId: 'baf1358ce8d74342af3340f621688e21',\r\n  webmapId: '54d46b14f5f74e59a523e0ae46ef8736',\r\n  //layerRefreshIntervalMin: 1,\r\n  initialRendererField: 'eventsubtype',\r\n  renderers : {\r\n    'eventsubtype': {\r\n      _type: \"jsapi\",\r\n      type: \"unique-value\",  // autocasts as new UniqueValueRenderer()\r\n      field: \"eventsubtype\",\r\n      //defaultSymbol: {type: \"simple-marker\", color: \"blue\"},\r\n      uniqueValueInfos: [{\r\n        value: \"pedestrians\",\r\n        symbol: {\r\n          type: \"picture-marker\",\r\n          url: pedImage\r\n        }\r\n      }, {\r\n        value: \"bicycles\",\r\n        symbol: {\r\n          type: \"picture-marker\",\r\n          url: bicycleImage\r\n        }\r\n      }\r\n      ]\r\n    }\r\n  }\r\n  ,\r\n  filters: [\r\n//    {name: 'eventvalue', type: 'minmax', params: {lowerBound: 0, upperBound: 20, log: true}},\r\n//    {name: 'eventtype', type: 'multiselect'},\r\n    {name: 'eventsubtype', type: 'multiselect'},\r\n//    {name: 'project', type: 'multiselect', params: {lowerBound: 0, upperBound: 100, log: true}},\r\n//    {name: 'eventtimestamp', type: 'minmax', params: {lowerBound: 0, upperBound: 100, log: true}},\r\n  ],\r\n  popupTemplate: {\r\n    title: \"Event information:\",\r\n    content: \"Event type: <b>{eventsubtype}</b><br>\" +\r\n        \"Project: {project}<br>\" +\r\n        \"Event value: {eventvalue}<br>\" +\r\n        \"Event timestamp: {eventtimestamp}\"\r\n  },\r\n  viewConfig: {\r\n    center: [-74.00157, 40.71955],\r\n    zoom: 12\r\n  }\r\n\r\n}\r\n\r\nexport default eventsConfig;\r\n\r\n\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport {\r\n  Switch,\r\n  Typography } from 'antd';\r\nimport FilterPanel from '../components/FilterPanel';\r\nimport PanelCard from '../components/PanelCard';\r\nimport LayerIcon from 'calcite-ui-icons-react/LayerIcon';\r\n\r\nconst { Text } = Typography;\r\n\r\n\r\nconst LayerPanel = observer(class LayerPanel extends React.Component{\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.eventFilter = props.store.filters.find(f => f.field === 'eventsubtype');\r\n  }\r\n\r\n  render(){\r\n\r\n    let domainMap = this.eventFilter.domainMap;\r\n    let eventOptions = this.eventFilter.options.map(o => {\r\n      let text = domainMap.has(o) ? domainMap.get(o) : o;\r\n      return (\r\n        <div key={o} style={{margin: \"5px 0px 0px 10px\"}}>\r\n          <Switch\r\n            size=\"small\"\r\n            style={{float: \"left\", marginTop: \"4px\"}}/>\r\n          <Text style={{margin: \"0px 0px 0px 5px\"}}>{text}</Text>\r\n        </div>\r\n      )\r\n    })\r\n\r\n    return (\r\n      <>\r\n        <PanelCard\r\n          icon={<LayerIcon size=\"20\" style={{position: \"relative\", top: \"4px\", left: \"0px\"}}/>}\r\n          title=\"Data\"\r\n          collapsible={true}\r\n          defaultActive={true}>\r\n          <Switch\r\n            onChange={this.onSwitchChange}\r\n            style={{float: \"left\", marginTop: \"1px\"}}/>\r\n          <h3 style={{display: \"inline-block\", margin: \"0px 0px 2px 10px\"}}>Road Safety Score</h3>\r\n          {eventOptions}\r\n        </PanelCard>\r\n      </>\r\n    )\r\n  }\r\n\r\n});\r\n\r\nexport default LayerPanel;\r\n","import React from 'react'\r\nimport { observer } from \"mobx-react\";\r\nimport { Layout, Menu, Drawer, Icon, Row, Col } from 'antd';\r\nimport LayerFilterIcon from 'calcite-ui-icons-react/LayersIcon';\r\nimport BookmarkIcon from 'calcite-ui-icons-react/BookmarkIcon';\r\nimport InformationIcon from 'calcite-ui-icons-react/InformationIcon';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../config/esri-loader-options';\r\nimport FilterPanel from '../components/FilterPanel';\r\nimport Store from '../stores/Store';\r\nimport eventsConfig from './EventsConfig';\r\nimport LayerPanel from './LayerPanel';\r\n\r\nconst { Header, Content, Sider } = Layout;\r\n\r\nconst MenuFilterIcon = () => (\r\n  <LayerFilterIcon size=\"18\" filled/>\r\n)\r\nconst MenuBookmarkIcon = () => (\r\n  <BookmarkIcon size=\"18\" filled/>\r\n)\r\nconst MenuInformationIcon = () => (\r\n  <InformationIcon size=\"17\" filled/>\r\n)\r\n\r\nconst EventsApp = observer(class App extends React.Component {\r\n\r\n  state = {\r\n    collapsed: true,\r\n    loaded: false,\r\n    navKey: \"Layers\"\r\n  };\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.mapViewRef = React.createRef();\r\n    this.sliderRef = React.createRef();\r\n    this.store = new Store(props.appState, eventsConfig);\r\n  }\r\n\r\n  onCollapse = collapsed => {\r\n    this.setState({ collapsed });\r\n  };\r\n\r\n  onSelect = item => {\r\n    const navKey = this.state.navKey === item.key\r\n      ? null\r\n      : item.key;\r\n    this.setState({navKey});\r\n  }\r\n\r\n  onClose = () => {\r\n    this.setState({\r\n      navKey: null,\r\n    });\r\n  };\r\n\r\n  componentDidMount = () => {\r\n\r\n    const modulePromise = loadModules([\r\n      'esri/widgets/Search',\r\n      'esri/widgets/Legend',\r\n      'esri/widgets/TimeSlider'\r\n\r\n    ], options);\r\n    const loadPromise = this.store.load(this.mapViewRef.current);\r\n\r\n    Promise.all([modulePromise, loadPromise])\r\n      .then(([[Search, Legend, TimeSlider], mapView]) => {\r\n        this.view = mapView;\r\n        const search = new Search({view: this.view});\r\n        const legend = new Legend({view: this.view, layerInfos: [{layer: this.store.lyr, title: \"\"}]});\r\n\r\n        // create a new time slider widget\r\n        // set other properties when the layer view is loaded\r\n        // by default timeSlider.mode is \"time-window\" - shows\r\n        // data falls within time range\r\n        const timeSlider = new TimeSlider({\r\n          container: \"timeSlider\",\r\n          mode: \"time-window\",\r\n          view: this.view,\r\n          loop: false\r\n\r\n        });\r\n\r\n        // const timeSlider = new TimeSlider({\r\n        //   container: \"timeSlider\",\r\n        //   playRate: 50,\r\n        //   stops: {\r\n        //     interval: {\r\n        //       value: 1,\r\n        //       unit: \"hours\"\r\n        //     }\r\n        //   }\r\n        // });\r\n        this.timeSlider = timeSlider;\r\n        //timeSlider.values = [new Date(2019, 1, 1), new Date(2020, 1, 1)];\r\n        this.view.ui.add(timeSlider, \"top-right\");\r\n        this.view.ui.add(search, \"top-right\");\r\n        this.view.ui.add(legend, \"bottom-right\");\r\n        this.view.ui.move(\"zoom\", \"top-right\");\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let panel;\r\n    switch (this.state.navKey) {\r\n      case 'Layers':\r\n        panel = <LayerPanel store={this.store}/>;\r\n        break;\r\n      case 'Bookmarks':\r\n        panel = <h1>Woah this are some awesome bookmarks!</h1>;\r\n        break;\r\n      case 'About':\r\n        panel = <h1>This is a slick app! Thanks Max!</h1>;\r\n        break;\r\n      default:\r\n        panel = null;\r\n    }\r\n\r\n    // Init Time Slider\r\n    if (this.store.layerLoaded){\r\n      const fullTimeExtent = this.store.lyr.timeInfo.fullTimeExtent;\r\n\r\n      // set up time slider properties\r\n      this.timeSlider.fullTimeExtent = fullTimeExtent;\r\n      // this.timeSlider.stops = {\r\n      //   interval: this.store.lyr.timeInfo.interval\r\n      // };\r\n    }\r\n\r\n\r\n    const signin = this.props.appState.displayName\r\n      ? (\r\n        <Menu\r\n          theme=\"dark\"\r\n          mode=\"horizontal\"\r\n          style={{ lineHeight: '64px', float: \"right\" }}\r\n        >\r\n          <Menu.Item key=\"sign in\">{this.props.appState.displayName}</Menu.Item>\r\n        </Menu>\r\n      )\r\n      : null;\r\n\r\n    return (\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <Header style={{paddingLeft: \"1rem\", paddingRight: \"0rem\"}}>\r\n          <h1 style={{color: \"rgba(255,255,255,0.8\", float: \"left\"}}>Mobileye City Lab</h1>\r\n          {signin}\r\n        </Header>\r\n        <Layout>\r\n          <Sider collapsible collapsed={this.state.collapsed} onCollapse={this.onCollapse}>\r\n            <Menu\r\n              defaultSelectedKeys={['0']}\r\n              mode=\"inline\"\r\n              theme=\"dark\"\r\n              selectedKeys={[this.state.navKey]}\r\n              onClick={this.onSelect}>\r\n              <Menu.Item key=\"Layers\">\r\n                <Icon component={MenuFilterIcon} />\r\n                <span>Layers</span>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"Bookmarks\">\r\n                <Icon component={MenuBookmarkIcon} />\r\n                <span>Bookmarks</span>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"About\">\r\n                <Icon component={MenuInformationIcon} />\r\n                <span>About</span>\r\n              </Menu.Item>\r\n            </Menu>\r\n          </Sider>\r\n          <Content>\r\n            <Row>\r\n              <Col\r\n                span={24}\r\n                style={{height: \"calc(100vh - 64px)\"}}>\r\n              <div\r\n                style={{ position: 'absolute', left: '30%', right: '15px', bottom: '30px'}}\r\n                ref={this.sliderRef}/>\r\n              <div\r\n                ref={this.mapViewRef}\r\n                style={{width: \"100%\", height: \"100%\"}}/>\r\n              <Drawer\r\n                // title={this.state.navKey}\r\n                closable={false}\r\n                // onClose={this.onClose}\r\n                placement=\"left\"\r\n                visible={this.state.navKey}\r\n                mask={false}\r\n                getContainer={false}\r\n                style={{ position: 'absolute', background: \"#f5f5f5\"}}\r\n                bodyStyle={{ padding: \"10px\", background: \"#f5f5f5\", height: \"100%\" }}\r\n              >\r\n                {panel}\r\n              </Drawer>\r\n            </Col>\r\n            </Row>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n});\r\n\r\nexport default EventsApp;","import React, { Component } from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport {transformQueryToRechartSeries} from '../../utils/Utils';\r\nimport {\r\n  BarChart, Bar, XAxis, YAxis\r\n} from 'recharts';\r\n\r\n\r\nconst MyBarChart = observer(class MyBarChart extends Component {\r\n\r\n  render() {\r\n    const store = this.props.store;\r\n    const config = this.props.config;\r\n    const {\r\n      id,\r\n      xField,\r\n      yField\r\n    } = {...config};\r\n    const chartResultMap = store.chartResultMap;\r\n    const queryData = chartResultMap.get(id);\r\n    const chartData = transformQueryToRechartSeries(queryData, xField, yField);\r\n\r\n    return (\r\n      <BarChart\r\n        width={320}\r\n        height={400}\r\n        data={chartData}\r\n        margin={{\r\n          top: 15, right: 0, left: 0, bottom: 0,\r\n        }}\r\n        layout=\"vertical\"\r\n      >\r\n        <XAxis type=\"number\" tick={{fontSize: 8}}/>\r\n        <YAxis type=\"category\" dataKey={xField} tick={{fontSize: 8}} width={50}/>\r\n        <Bar dataKey={yField} fill=\"#8884d8\" />\r\n      </BarChart>\r\n    );\r\n  }\r\n});\r\n\r\n\r\nexport default MyBarChart;\r\n","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport BarChart from './charts/BarChart';\r\nimport PanelCard from './PanelCard';\r\nimport GraphHistogramIcon from 'calcite-ui-icons-react/GraphHistogramIcon';\r\nimport './FilterPanel.css';\r\n\r\nconst getChartView = (chart, store) => {\r\n  const c = chart;\r\n  switch(c.type){\r\n    case 'bar':\r\n      return <BarChart config={c} store={store}/>\r\n    default:\r\n      throw new Error(\"Unknown chart type!\");\r\n  }\r\n}\r\n\r\nconst FilterPanel = observer(class FilterPanel extends React.Component{\r\n\r\n  render(){\r\n    const charts = this.props.store.charts;\r\n    const chartViews = charts.map(c => \r\n      <div key={c.id}>\r\n        <h4>{c.title}</h4>\r\n        {getChartView(c, this.props.store)}\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <PanelCard\r\n        title=\"Charts\"\r\n        icon={<GraphHistogramIcon size=\"20\" style={{position: \"relative\", top: \"3px\", left: \"0px\"}}/>}\r\n        collapsible={true}\r\n        defaultActive={true}>\r\n        {chartViews}\r\n      </PanelCard>\r\n\r\n    )\r\n  }\r\n  \r\n});\r\n\r\nexport default FilterPanel;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport {\r\n  Switch } from 'antd';\r\nimport PanelCard from '../components/PanelCard';\r\nimport LayerIcon from 'calcite-ui-icons-react/LayerIcon';\r\nimport './LayerListPanel.css'\r\n\r\nconst ListLayer = observer(class ListLayer extends React.Component{\r\n\r\n  onToggle = () => {\r\n    this.props.store.toggleLayerVisibility(this.props.layer);\r\n  }\r\n\r\n  render(){\r\n    \r\n    const visibleMap = this.props.store.layerVisibleMap;\r\n    const l = this.props.layer;\r\n    const isVisible = visibleMap.has(l.id) && visibleMap.get(l.id);\r\n\r\n    return(\r\n      <div>\r\n        <Switch\r\n          defaultChecked={true}\r\n          checked={isVisible}\r\n          onChange={this.onToggle}\r\n          className=\"layer-list-switch\"/>\r\n        <h3 className=\"layer-list-header\">{this.props.layer.title}</h3>\r\n      </div> \r\n    )\r\n  }\r\n});\r\n\r\nconst LayerPanel = observer(class LayerPanel extends React.Component{\r\n\r\n  render(){\r\n    const layers = this.props.store.layers;\r\n    const layerListViews = layers.map(l => {\r\n      return <ListLayer key={l.id} layer={l} store={this.props.store}/>\r\n    });\r\n\r\n    return (\r\n      <>\r\n        <PanelCard\r\n          icon={<LayerIcon size=\"20\" style={{position: \"relative\", top: \"4px\", left: \"0px\"}}/>}\r\n          title=\"Layer List\"\r\n          collapsible={true}\r\n          defaultActive={true}>\r\n          {layerListViews}\r\n        </PanelCard>\r\n      </>\r\n    )\r\n  }\r\n\r\n});\r\n\r\nexport default LayerPanel;\r\n","import { getDomainMap } from '../utils/Utils';\r\n\r\n// import sign5Image from '../resources/images/SIGN_ICON_5.png'\r\n// import sign10Image from '../resources/images/SIGN_ICON_10.png'\r\n// import sign15Image from '../resources/images/SIGN_ICON_15.png'\r\n// import sign20Image from '../resources/images/SIGN_ICON_20.png'\r\n// import sign25Image from '../resources/images/SIGN_ICON_25.png'\r\n// import sign30Image from '../resources/images/SIGN_ICON_30.png'\r\n// import sign35Image from '../resources/images/SIGN_ICON_35.png'\r\n// import sign40Image from '../resources/images/SIGN_ICON_40.png'\r\n// import sign45Image from '../resources/images/SIGN_ICON_45.png'\r\n// import sign50Image from '../resources/images/SIGN_ICON_50.png'\r\n// import sign55Image from '../resources/images/SIGN_ICON_55.png'\r\n// import sign60Image from '../resources/images/SIGN_ICON_60.png'\r\n// import sign65Image from '../resources/images/SIGN_ICON_65.png'\r\n// import sign70Image from '../resources/images/SIGN_ICON_70.png'\r\n// import sign75Image from '../resources/images/SIGN_ICON_75.png'\r\n// import sign80Image from '../resources/images/SIGN_ICON_80.png'\r\n// import sign85Image from '../resources/images/SIGN_ICON_85.png'\r\n// import sign90Image from '../resources/images/SIGN_ICON_90.png'\r\n// import sign95Image from '../resources/images/SIGN_ICON_95.png'\r\n// import sign100Image from '../resources/images/SIGN_ICON_100.png'\r\n// import sign105Image from '../resources/images/SIGN_ICON_105.png'\r\n// import sign110Image from '../resources/images/SIGN_ICON_110.png'\r\n// import sign115Image from '../resources/images/SIGN_ICON_115.png'\r\n// import sign120Image from '../resources/images/SIGN_ICON_120.png'\r\n// import sign125Image from '../resources/images/SIGN_ICON_125.png'\r\n// import sign130Image from '../resources/images/SIGN_ICON_130.png'\r\n// import sign135Image from '../resources/images/SIGN_ICON_135.png'\r\n// import sign140Image from '../resources/images/SIGN_ICON_140.png'\r\n// import sign145Image from '../resources/images/SIGN_ICON_145.png'\r\n// import circularSignNoSpeedImage from '../resources/images/CIRCULAR_NO_SPEED.png'\r\n// import warningImage from '../resources/images/WARNING.png'\r\n// import constructionImage from '../resources/images/CONSTRUCTION.png'\r\n// import rectangularSignImage from '../resources/images/RECTANGULAR.png'\r\n// import trafficLightImage from '../resources/images/TRAFFIC_LIGHTS.png'\r\n// import diamondImage from '../resources/images/DIAMOND.png'\r\n// import yieldImage from '../resources/images/YIELD.png'\r\n// import roadArrowImage from '../resources/images/ROAD_MARKINGS_ARROWS.png'\r\n// import roadStoplineImage from '../resources/images/ROAD_MARKINGS_STOPLINE.png'\r\n// import overheadStructureImage from '../resources/images/HORIZONTAL.png'\r\n// import reflectorImage from '../resources/images/REFLECTORS.png'\r\n// import roadCrossingImage from '../resources/images/CROSSING.png'\r\n// import manholeImage from '../resources/images/MANHOLE_COVER.png'\r\n// import unrecognizedCircleImage from '../resources/images/UNRECOGNIZED_CIRCLE.png'\r\n// import unrecognizedRectImage from '../resources/images/UNRECOGNIZED_RECT.png'\r\n// import NYCImage from '../resources/images/NYC.png'\r\n\r\nconst surveyConfig = {\r\n  \r\n  // Production\r\n  layerItemId: '3d218196cda94e2eacf86994f9bbd4e4',\r\n  webmapId: 'e89e13f2f6174777bcd81073c4158ce6',\r\n  // Test\r\n  //layerItemId: '5d31985daf4c403ba6786c02a52ea715',\r\n  // layerItemId: '3fd4485bb8ca45bfa90e0e143c2cd7c2',\r\n  // webmapId: 'aabc5fa9e96045eaa0968702fd33e6d9',\r\n  initialRendererField: 'all',\r\n  renderers: {\r\n    'all': {\r\n      _type: \"jsapi\",\r\n      type: \"unique-value\",  // autocasts as new UniqueValueRenderer()\r\n      field: \"icon\",\r\n      //field: \"system_type_group\",\r\n      defaultSymbol: {type: \"simple-marker\", color: \"blue\"},\r\n      visualVariables: [{\r\n        type: \"opacity\",\r\n        field: \"comparsion_to_prev_map\",\r\n        stops: [\r\n              {value: '2', opacity: 0.3},\r\n              {value: '1', opacity: 1},\r\n              {value: '0', opacity: 1}\r\n        ]\r\n      },\r\n      \r\n      ],\r\n      uniqueValueInfos: [\r\n        {value: 'sign5', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign5Image}},\r\n        {value: 'sign10', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign10Image}},\r\n        {value: 'sign15', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign15Image}},\r\n        {value: 'sign20', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign20Image}},\r\n        {value: 'sign25', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign25Image}},\r\n        {value: 'sign30', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign30Image}},\r\n        {value: 'sign35', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign35Image}},\r\n        {value: 'sign40', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign40Image}},\r\n        {value: 'sign45', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign45Image}},\r\n        {value: 'sign50', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign50Image}},\r\n        {value: 'sign55', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign55Image}},\r\n        {value: 'sign60', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign60Image}},\r\n        {value: 'sign65', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign65Image}},\r\n        {value: 'sign70', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign70Image}},\r\n        {value: 'sign75', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign75Image}},\r\n        {value: 'sign80', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign80Image}},\r\n        {value: 'sign85', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign85Image}},\r\n        {value: 'sign90', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign90Image}},\r\n        {value: 'sign95', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign95Image}},\r\n        {value: 'sign100', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign100Image}\r\n        {value: 'sign105', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign105Image}},},\r\n        {value: 'sign110', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign110Image}\r\n        {value: 'sign115', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign115Image}},},\r\n        {value: 'sign120', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign120Image}\r\n        {value: 'sign125', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign125Image}},},\r\n        {value: 'sign130', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign130Image}},\r\n        {value: 'sign135', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign135Image}},\r\n        {value: 'sign140', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign140Image}},\r\n        {value: 'sign145', symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}}, //{type: \"picture-marker\", url: sign145Image}},\r\n        {value: 'CIRCULAR_NO_SPEED', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: circularSignNoSpeedImage}},\r\n        {value: 'WARNING', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: warningImage}},\r\n        {value: 'CONSTRUCTION', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: constructionImage}},\r\n        {value: 'RECTANGULAR', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: rectangularSignImage}},\r\n        {value: 'TRAFFIC_LIGHTS', symbol: {type: \"simple-marker\", size:6.0, color: \"purple\"}}, //{type: \"picture-marker\", url: trafficLightImage}},\r\n        {value: 'DIAMOND', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: diamondImage}},\r\n        {value: 'YIELD', symbol: {type: \"simple-marker\", size:6.0, color: \"red\"}}, //{type: \"picture-marker\", url: yieldImage}},\r\n        {value: 'ROAD_MARKINGS_ARROWS', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"picture-marker\", url: roadArrowImage}},\r\n        {value: 'ROAD_MARKINGS_STOPLINE', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"picture-marker\", url: roadStoplineImage}},\r\n        {value: 'DOT1', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"simple-marker\",color: \"white\"}},\r\n        {value: 'HORIZONTAL', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"picture-marker\", url: overheadStructureImage}},\r\n        {value: 'REFLECTORS', symbol: {type: \"simple-marker\", size:6.0, color: \"green\"}}, //{type: \"picture-marker\", url: reflectorImage}},\r\n        {value: 'CROSSING', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"picture-marker\", url: roadCrossingImage}},\r\n        {value: 'MANHOLE_COVER', symbol: {type: \"simple-marker\", size:6.0, color: \"yellow\"}}, //{type: \"picture-marker\", url: manholeImage}},\r\n        {value: 'DOT2', symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}}, //{type: \"simple-marker\",color: \"black\"}},\r\n        {value: 'UNRECOGNIZED_CIRCLE', symbol: {type: \"simple-marker\", size:3.0, color: \"black\"}}, // {type: \"picture-marker\", url: unrecognizedCircleImage}},\r\n        {value: 'UNRECOGNIZED_RECRANGLE', symbol:  {type: \"simple-marker\", size:3.0, color: \"black\"}} //{type: \"picture-marker\", url: unrecognizedRectImage}}\r\n        // {value: 0, symbol: {type: \"simple-marker\", size:6.0, color: \"orange\"}},\r\n        // {value: 1, symbol: {type: \"simple-marker\", size:6.0, color: \"purple\"}},\r\n        // {value: 2, symbol: {type: \"simple-marker\", size:6.0, color: \"blue\"}},\r\n        // {value: 3, symbol: {type: \"simple-marker\", size:6.0, color: \"green\"}},\r\n        // {value: 4, symbol: {type: \"simple-marker\", size:6.0, color: \"yellow\"}},\r\n    ]\r\n  }\r\n  },\r\n  filters: [\r\n    {name: 'system_type', type: 'multiselect', params: {dynamic: true}},\r\n    {name: 'comparsion_to_prev_map', type: 'multiselect', params: {dynamic: true}},\r\n    {name: 'map_version', type: 'select', params: {dynamic: true}},\r\n  ],\r\n  charts: [\r\n  {\r\n    id: 'system_type_group_label',\r\n    type: 'bar',\r\n    title: 'Landmark Type',\r\n    xField: 'system_type_group_label',\r\n    yField: 'countOFsystem_type_group',\r\n    // see here\r\n    // https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-Query.html\r\n    // and here\r\n    // https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-StatisticDefinition.html\r\n    // use \"order by\" parameter or \"resultTransform\" to sort\r\n   queryDefinition: {\r\n        where: \"1=1\",\r\n        outFields: \"*\",\r\n        orderByFields: \"countOFsystem_type_group\",\r\n        groupByFieldsForStatistics: \"system_type_group\",\r\n        outStatistics: [{\r\n          \"onStatisticField\":\"system_type_group\",\r\n          \"outStatisticFieldName\":\"countOFsystem_type_group\",\r\n          \"statisticType\":\"count\"\r\n      }]\r\n    },\r\n    resultTransform: result => {\r\n      if(!result || !result.features || result.features.length < 1) return result;\r\n      const field = result.fields.find(f => f.name === 'system_type_group');\r\n      const domainMap = getDomainMap(field.domain);\r\n      const newFeatures = result.features.map(f => {  \r\n        const attributes = f.attributes;\r\n        const fieldValue = f.attributes['system_type_group'];\r\n        const fieldDomain = domainMap.has(fieldValue) ? domainMap.get(fieldValue) : fieldValue;\r\n        return {\r\n          attributes: {\r\n            ...attributes,\r\n            system_type_group_label: fieldDomain\r\n          }\r\n        }\r\n      });\r\n      result.features = newFeatures;\r\n      return result;\r\n    }\r\n  },\r\n  {\r\n    id: 'system_type_label',\r\n    type: 'bar',\r\n    title: 'Specific Landmark type',\r\n    xField: 'system_type_label',\r\n    yField: 'countOFsystem_type',\r\n    // see here\r\n    // https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-Query.html\r\n    // and here\r\n    // https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-StatisticDefinition.html\r\n    // use \"order by\" parameter or \"resultTransform\" to sort\r\n    queryDefinition: {\r\n      where: \"1=1\",\r\n      outFields: \"*\",\r\n      orderByFields: \"countOFsystem_type\",\r\n      groupByFieldsForStatistics: \"system_type\",\r\n      outStatistics: [{\r\n        \"onStatisticField\":\"system_type\",\r\n        \"outStatisticFieldName\":\"countOFsystem_type\",\r\n        \"statisticType\":\"count\"\r\n      }]\r\n      },\r\n    resultTransform: result => {\r\n      if(!result || !result.features || result.features.length < 1) return result;\r\n      const field = result.fields.find(f => f.name === 'system_type');\r\n      const domainMap = getDomainMap(field.domain);\r\n      const newFeatures = result.features.map(f => {  \r\n        const attributes = f.attributes;\r\n        const fieldValue = f.attributes['system_type'];\r\n        const fieldDomain = domainMap.has(fieldValue) ? domainMap.get(fieldValue) : fieldValue;\r\n        return {\r\n          attributes: {\r\n            ...attributes,\r\n            system_type_label: fieldDomain\r\n          }\r\n        }\r\n      });\r\n      result.features = newFeatures;\r\n      return result;\r\n    }\r\n  },], \r\n  popupTemplate: {\r\n    title: \"{expression/title-prefix} {system_type} {expression/title_suffix}\",\r\n    content: [\r\n      \r\n      {\r\n      type: \"text\",\r\n      text: \"Type: <b>{expression/type-expr}</b> <br>\" +\r\n             \"Detected at {publish_date} (version {map_version})<br>\" +\r\n             \"Size: {height} X {width} m<br>\",\r\n    }, \r\n    // {\r\n    //   type: \"media\", // MediaContentElement\r\n    //   mediaInfos: [\r\n    //     {\r\n    //       title: \"\",\r\n    //       type: \"image\",\r\n    //       caption: \"sign icon\",\r\n    //       size: 3.0,\r\n    //       value: {\r\n    //         sourceURL: \"{expression/sign-icon}\"\r\n    //       }\r\n    //     },\r\n    //   ]\r\n    // },\r\n    ],\r\n    expressionInfos: [\r\n      {\r\n        name: \"type-expr\",\r\n        title: \"Type\",\r\n        expression: \"When($feature.system_type_group == 0, DomainName($feature, 'traffic_sign_type', $feature.traffic_sign_type),\" +\r\n                        \"$feature.system_type_group == 1, 'Traffic Light',\" +\r\n                        \"$feature.system_type_group == 2, DomainName($feature, \\\"road_marking_type\\\", $feature.road_marking_type),\" +\r\n                       \"$feature.system_type_group == 3, DomainName($feature, \\\"pole_type\\\", $feature.pole_type),\" +\r\n//                        \"$feature.system_type_group == 4, DomainName($feature, \\\"manhole_type\\\", $feature.manhole_type),\" +\r\n                        \"'')\"\r\n\r\n      },\r\n      {\r\n        name: \"title-prefix\",\r\n        title: \"Title Prefix\",\r\n        expression: \"When($feature.comparsion_to_prev_map == 2, 'Missing', $feature.comparsion_to_prev_map == 1, 'New',  '')\"\r\n      },\r\n      {\r\n        name: \"title-suffix\",\r\n        title: \"Title Suffix\",\r\n        expression: \"When(($feature.comparsion_to_prev_map == 2) ||  ($feature.comparsion_to_prev_map == 1), '',  'information')\"\r\n      },\r\n      // {\r\n      //   name: \"sign-icon\",\r\n      //   expression: \"${sign5Image}\"\r\n      // }\r\n    ],\r\n  },\r\n  \r\n  bookmarkInfos: {\r\n   'ORK': {\r\n       title: '61st on 1st',\r\n        content: 'The most beutiful traffic light in all of NYC.'\r\n    },\r\n  },\r\n\r\n  geocenters: [{\r\n    'name' : 'NYC',\r\n    'image' : 'NYCImage',\r\n    'extent' : {\r\n                 \"xmin\":-73.959285,\"ymin\":40.757012,\"xmax\":-74.005712,\"ymax\":40.758693,\r\n                 \"spatialReference\":{\"wkid\":102100}\r\n               }\r\n  }],\r\n  \r\n  viewConfig: { \r\n    // center: [-73.974051, 40.762746],\r\n    center: [-84.386330, 33.753746],\r\n    zoom: 16\r\n  }\r\n}\r\n\r\nexport default surveyConfig;","import React from 'react';\r\nimport { observer } from \"mobx-react\";\r\nimport { Layout, Menu, Drawer, Icon, Row, Col , Card} from 'antd';\r\nimport LayerFilterIcon from 'calcite-ui-icons-react/LayersIcon';\r\nimport GraphHistogramIcon from 'calcite-ui-icons-react/GraphHistogramIcon';\r\nimport BookmarkIcon from 'calcite-ui-icons-react/BookmarkIcon';\r\nimport InformationIcon from 'calcite-ui-icons-react/InformationIcon';\r\nimport {loadModules} from 'esri-loader';\r\nimport options from '../config/esri-loader-options';\r\nimport FilterPanel from '../components/FilterPanel';\r\nimport ChartPanel from '../components/ChartPanel';\r\nimport LayerListPanel from '../components/LayerListPanel';\r\nimport BookmarkPanel from '../components/BookmarkPanel';\r\nimport Store from '../stores/Store';\r\nimport surveyConfig from './SurveyConfig';\r\n//import GeocenterPanel from '../components/GeoCentersPanel';\r\n\r\nconst { Header, Content, Sider } = Layout;\r\n\r\nconst MenuFilterIcon = () => (\r\n  <LayerFilterIcon size=\"18\" filled/>\r\n)\r\nconst MenuHistogramIcon = () => (\r\n  <GraphHistogramIcon size=\"18\" filled/>\r\n)\r\nconst MenuBookmarkIcon = () => (\r\n  <BookmarkIcon size=\"18\" filled/>\r\n)\r\nconst MenuInformationIcon = () => (\r\n  <InformationIcon size=\"17\" filled/>\r\n)\r\n\r\nconst SurveyApp = observer(class App extends React.Component {\r\n\r\n  state = {\r\n    collapsed: true,\r\n    loaded: false,\r\n    navKey: \"Layers\"\r\n  };\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    this.mapViewRef = React.createRef();\r\n    this.store = new Store(props.appState, surveyConfig);\r\n  }\r\n\r\n  onCollapse = collapsed => {\r\n    this.setState({ collapsed });\r\n  };\r\n\r\n  onSelect = item => {\r\n    const navKey = this.state.navKey === item.key\r\n      ? null\r\n      : item.key;\r\n    this.setState({navKey});\r\n  }\r\n\r\n  onClose = () => {\r\n    this.setState({\r\n      navKey: null,\r\n    });\r\n  };\r\n\r\n  componentDidMount = () => {\r\n\r\n    const modulePromise = loadModules([\r\n      'esri/widgets/Search',\r\n      // 'esri/widgets/Legend'\r\n    ], options);\r\n    const loadPromise = this.store.load(this.mapViewRef.current);\r\n\r\n    Promise.all([modulePromise, loadPromise])\r\n      .then(([[Search, Legend], mapView]) => {\r\n        this.view = mapView;\r\n        const search = new Search({view: this.view});\r\n        this.view.ui.add(search, \"top-right\");\r\n        // const legend = new Legend({view: this.view});\r\n        // this.view.ui.add(legend, \"bottom-right\");\r\n        this.view.ui.move(\"zoom\", \"top-right\");\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let panel;\r\n    switch(this.state.navKey){\r\n      case 'Layers':\r\n        panel = (\r\n          <div>\r\n            <LayerListPanel store={this.store}/>\r\n            <FilterPanel store={this.store} defaultActive={true}/>\r\n          </div>\r\n        );\r\n        break;\r\n      case 'Histograms':\r\n        panel = <ChartPanel store={this.store}/>\r\n        break;\r\n      case 'Saved Locations':\r\n        panel = <BookmarkPanel store={this.store}/>\r\n        break;\r\n      case 'About':\r\n        panel = <h1>This application presents the various assets Mobileye is able to survey and map</h1>;\r\n        break;\r\n      default:\r\n        panel = null;\r\n    }\r\n\r\n    const signin = this.props.appState.displayName\r\n      ? (\r\n        <Menu\r\n          theme=\"dark\"\r\n          mode=\"horizontal\"\r\n          style={{ lineHeight: '64px', float: \"right\" }}\r\n        >\r\n          <Menu.Item key=\"sign in\" onClick={this.onSignOutClick}>\r\n            <Icon type=\"logout\"/>\r\n            {this.props.appState.displayName}\r\n          </Menu.Item>\r\n        </Menu>\r\n      )\r\n      : null;\r\n\r\n\r\n    let bookmarkCard;\r\n    if(this.store.bookmarkInfo){\r\n      bookmarkCard = (\r\n        <Card\r\n          title={this.store.bookmarkInfo.title}\r\n          className=\"antd-esri-widget\"\r\n          style={{\r\n            position: \"absolute\",\r\n            bottom: \"30px\",\r\n            width: \"400px\",\r\n            left: \"50%\",\r\n            marginLeft: \"-200px\",\r\n          }}\r\n          size=\"small\">\r\n          {this.store.bookmarkInfo.content}\r\n        </Card>\r\n      )\r\n    }\r\n    return (\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <Header style={{paddingLeft: \"1rem\", paddingRight: \"0rem\"}}>\r\n          <h1 style={{color: \"rgba(255,255,255,0.8\", float: \"left\"}}>Streets Survey</h1>\r\n          {signin}\r\n        </Header>\r\n        <Layout>\r\n          <Sider collapsible collapsed={this.state.collapsed} onCollapse={this.onCollapse}>\r\n            <Menu\r\n              defaultSelectedKeys={['0']}\r\n              mode=\"inline\"\r\n              theme=\"dark\"\r\n              selectedKeys={[this.state.navKey]}\r\n              onClick={this.onSelect}>\r\n              <Menu.Item key=\"Layers\">\r\n                <Icon component={MenuFilterIcon} />\r\n                <span>Layers</span>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"Histograms\">\r\n                <Icon component={MenuHistogramIcon} />\r\n                <span>Histograms</span>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"Saved Locations\">\r\n                <Icon component={MenuBookmarkIcon} />\r\n                <span>Saved Locations</span>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"About\">\r\n                <Icon component={MenuInformationIcon} />\r\n                <span>About</span>\r\n              </Menu.Item>\r\n            </Menu>\r\n          </Sider>\r\n          <Content>\r\n            <Row>\r\n              <Col\r\n                span={24}\r\n                style={{height: \"calc(100vh - 64px)\"}}>\r\n              <div\r\n                ref={this.mapViewRef}\r\n                style={{width: \"100%\", height: \"100%\"}}/>\r\n              {bookmarkCard}\r\n              <Drawer\r\n                title={this.state.navKey}\r\n                closable={true}\r\n                onClose={this.onClose}\r\n                placement=\"left\"\r\n                visible={this.state.navKey}\r\n                mask={false}\r\n                width={320}\r\n                getContainer={false}\r\n                style={{ position: 'absolute', background: \"#f5f5f5\", height: \"calc(100% - 15px)\"}}\r\n                bodyStyle={{ padding: \"10px\", background: \"#f5f5f5\", height: \"100%\"}}\r\n              >\r\n                {panel}\r\n              </Drawer>\r\n            </Col>\r\n            </Row>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n});\r\n\r\n\r\nexport default SurveyApp;","const config = {\r\n  appId: \"o3Zbi02dIsAez6sL\",\r\n  portalUrl: \"https://www.arcgis.com/sharing\"\r\n}\r\n\r\nexport default config;","import React from 'react'\r\nimport { observer } from \"mobx-react\";\r\nimport { HashRouter as Router, BrowserRouter, Route, Link, Redirect } from \"react-router-dom\";\r\nimport { Row, Col, Card, Layout, Button, Divider } from 'antd';\r\nimport AppState from './stores/AppState';\r\nimport MapImage from './resources/images/map.png';\r\nimport SafetyApp from './safety/SafetyApp';\r\nimport EventsApp from './events/EventsApp';\r\nimport SurveyApp from './survey/SurveyApp';\r\nimport {\r\n  UserSession\r\n} from \"@esri/arcgis-rest-auth\";\r\nimport config from './config/config';\r\nimport {loadScript} from 'esri-loader';\r\nimport options from './config/esri-loader-options';\r\n\r\nconst { Content } = Layout;\r\nconst { appId } = config;\r\n\r\n// TODO, see if faster way to accept callback without loading whole app\r\nconst OAuth = _ => {\r\n  UserSession.completeOAuth2({\r\n    clientId: appId,\r\n  });\r\n  return(\r\n    <div/>\r\n  )\r\n}\r\n\r\nconst PrivateRoute = observer(({Component, appState, ...rest}) => {\r\n  const isAuth = appState.isAuthenticated; //needed to trigger mobx\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) => (\r\n        isAuth === true\r\n          ? <Component appState={appState} {...props}/>\r\n          : <Redirect to={{\r\n              pathname: '/',\r\n              state: {from: props.location}\r\n            }}/>\r\n      )}/>\r\n    )\r\n});\r\n\r\nconst Home = observer(class Home extends React.Component{\r\n  \r\n  componentDidMount(){\r\n    loadScript(options);\r\n  }\r\n\r\n  render(){\r\n    let appState = this.props.appState;\r\n\r\n    let topComponent = appState.isAuthenticated\r\n      ? <h1>Hello <b>{appState.displayName}</b>, please select the application you would like to use:</h1>\r\n      : <Button type=\"primary\" size=\"large\" onClick={appState.login}>Log in to get started</Button>;\r\n\r\n    const {from} = this.props.location.state || {from: null};\r\n    if(appState.redirectToReferrer && from){\r\n      return <Redirect to={from}/>\r\n    }\r\n\r\n    // Not good practice, should find a way to inject router Link into antd Button\r\n    const linkClass = \"ant-btn ant-btn-primary ant-btn-background-ghost ant-btn-block ant-btn ant-btn-lg\";\r\n\r\n    return(\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <Content style={{ padding: '50px 50px'}}>\r\n          <Row type=\"flex\" justify=\"space-around\" align=\"middle\">\r\n            <Col style={{textAlign: 'center'}}>\r\n              {topComponent}\r\n            </Col>\r\n          </Row>\r\n          <Divider/>\r\n          <Row type=\"flex\" justify=\"space-around\" align=\"middle\">\r\n            <Col md={{span: 0}} xl={{span: 2}}/>\r\n            <Col md={{span: 6}} xl={{span: 4}}>\r\n              <Card\r\n              cover={<img alt=\"example\" src={MapImage} />}>\r\n                <Link\r\n                  to=\"/safety\"\r\n                  className={linkClass}\r\n                  disabled={!appState.isAuthenticated}>\r\n                  Explore Safety\r\n                </Link>\r\n              </Card>\r\n            </Col>\r\n            <Col md={{span: 6}} xl={{span: 4}}>\r\n              <Card\r\n              cover={<img alt=\"example\" src={MapImage}/>}>\r\n                <Link\r\n                  to=\"/events\"\r\n                  className={linkClass}\r\n                  disabled={!appState.isAuthenticated}>\r\n                  Explore Events\r\n                </Link>\r\n              </Card>\r\n            </Col>\r\n            <Col md={{span: 6}} xl={{span: 4}}>\r\n              <Card\r\n              cover={<img alt=\"example\" src={MapImage} />}>\r\n              <Link\r\n                to=\"/survey\"\r\n                className={linkClass}\r\n                disabled={!appState.isAuthenticated}>\r\n                Explore Survey\r\n              </Link>\r\n              </Card>\r\n            </Col>\r\n            <Col md={{span: 0}} xl={{span: 2}}/>\r\n          </Row>\r\n        </Content>\r\n      </Layout>\r\n    )\r\n  }\r\n});\r\n\r\n\r\nclass App extends React.Component{\r\n\r\n  constructor(props, context){\r\n    super(props, context);\r\n    const relativeRedirectUri = '';\r\n    this.appState = new AppState({...config, relativeRedirectUri});\r\n    console.log('v 0.0.0.6')\r\n  }\r\n\r\n  render(){\r\n    if(window.location.hash.includes(\"access_token=\")){\r\n      return (\r\n        <BrowserRouter>\r\n          <Route path=\"/\" component={OAuth} />\r\n        </BrowserRouter>\r\n      )\r\n    }\r\n    return(\r\n      <Router>\r\n        <Route\r\n          path=\"/\"\r\n          exact\r\n          render={props => <Home {...props} appState={this.appState}/>}/>\r\n        <PrivateRoute\r\n          path=\"/safety\"\r\n          appState={this.appState}\r\n          Component={SafetyApp}/>\r\n        <PrivateRoute\r\n          path=\"/events\"\r\n          appState={this.appState}\r\n          Component={EventsApp}/>\r\n        <PrivateRoute\r\n          path=\"/survey\"\r\n          appState={this.appState}\r\n          Component={SurveyApp}/>\r\n      </Router>\r\n    )\r\n  }\r\n}\r\n\r\nexport default App;","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n \r\nReactDOM.render(\r\n    <App />,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}